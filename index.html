<!-- ✨ 통합본 (탭형) — 파트 1/3: DOCTYPE ~ 스타일, 헤더/레이아웃/홈/방송국/당근/통계 -->
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>떡잎방범대 정보 센터</title>
  <style>
    :root{
      --card:#ffffff; --ink:#0f172a; --muted:#475569; --accent:#22c55e; --border:#e5e7eb;
      --company:#3b82f6; --civil:#16a34a; --org:#8b5cf6; --magazine:#f97316;
      --up:#16a34a; --down:#dc2626; --e:cubic-bezier(.22,.9,.24,1);
    }

    /* ★ 전역 박스사이징 */
    html { box-sizing: border-box; font-size:17px; overflow-y:scroll; }
    *, *::before, *::after { box-sizing: inherit; }

    body{
      margin:0;
      font-family:"Noto Sans KR",system-ui,-apple-system,Segoe UI,Roboto,sans-serif;
      color:var(--ink);
      background:#f0fdf4;
      line-height:1.6
    }

    /* 헤더 */
    header{background:#fff;border-bottom:1px solid var(--border);padding:20px;text-align:center;box-shadow:0 2px 6px rgba(0,0,0,.05)}
    header h1{margin:0;font-size:30px;color:var(--accent);font-weight:900;cursor:pointer;transition:transform .2s var(--e)}
    header h1:hover{transform:scale(1.02)}

    /* 레이아웃 */
    .layout{display:grid;grid-template-columns:300px 1fr 300px;column-gap:40px;row-gap:24px;max-width:1600px;margin:20px auto;padding:0 30px}
    main{display:flex;flex-direction:column;gap:20px}

    /* 좌우 사이드 */
    aside{background:var(--card);border-radius:14px;padding:20px;box-shadow:0 4px 12px rgba(0,0,0,.06);position:sticky;top:20px;height:500px;overflow-y:auto}
    aside h3{margin:0 0 12px;color:var(--accent);font-size:16px;font-weight:700}
    aside ul{margin:0;padding-left:18px}
    aside li{margin-bottom:6px}
    .aside-box{margin-bottom:20px;padding:12px;border-radius:10px;background:#fff}
    .aside-box h3{margin:0 0 10px;font-size:16px;font-weight:700;color:var(--accent)}

    /* 히어로 */
    .hero{text-align:center;padding:40px;border-radius:16px;background:linear-gradient(135deg,#bbf7d0,#ecfdf5);box-shadow:0 6px 16px rgba(0,0,0,.08);margin:20px 0;animation:fadeIn .35s var(--e)}
    .hero h2{margin:0 0 14px;color:var(--accent);font-size:26px;font-weight:800}
    .hero p{font-size:16px;color:#374151}

    /* 상단 네비 카드 */
    .nav-parts{display:flex;justify-content:center;gap:24px;margin:20px auto;flex-wrap:wrap}
    .nav-card{flex:1;min-width:150px;max-width:200px;background:linear-gradient(135deg,#dcfce7,#f0fdf4);padding:22px 16px;text-align:center;border-radius:16px;box-shadow:0 6px 14px rgba(0,0,0,.08);cursor:pointer;transition:transform .25s var(--e), box-shadow .25s var(--e)}
    .nav-card:hover{transform:translateY(-6px);box-shadow:0 10px 24px rgba(0,0,0,.12)}
    .nav-card .icon{font-size:28px;margin-bottom:10px}
    .nav-card h3{margin:0;font-size:18px;color:var(--accent);font-weight:700}

    /* 페이지(홈 등) */
    section.page{display:none;padding:28px;background:var(--card);border-radius:14px;box-shadow:0 4px 12px rgba(0,0,0,.05)}
    section.page.active{display:block;animation:pageIn .28s var(--e)}
    section h2{margin:0 0 16px;color:var(--accent);font-size:21px;font-weight:700}

    /* 홈 하위 탭 */
    .sub-nav{display:flex;gap:12px;margin:20px 0;flex-wrap:wrap;justify-content:center}
    .sub-nav button{padding:10px 18px;border:none;border-radius:8px;background:var(--accent);color:#fff;font-size:15px;font-weight:600;cursor:pointer;transition:transform .18s var(--e), filter .18s var(--e)}
    .sub-nav button:hover{filter:brightness(.96); transform:translateY(-2px)}
    .sub-page{display:none;margin-top:16px}
    .sub-page.active{display:block;animation:fadeIn .25s var(--e)}

    /* 홈 카드 */
    .card-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:20px;margin-top:16px}
    .card{background:#fff;border-radius:14px;padding:20px;box-shadow:0 4px 12px rgba(0,0,0,.08);transition:transform .25s var(--e),box-shadow .25s var(--e);cursor:pointer;text-align:center;border:2px solid transparent}
    .card:hover{transform:translateY(-6px);box-shadow:0 10px 24px rgba(0,0,0,.12)}
    .card .icon{font-size:30px;margin-bottom:12px}
    .card h4{margin:0 0 6px;font-size:17px;font-weight:700}
    .card p{margin:0;font-size:14.5px;color:#4b5563}
    .company-card{border-color:var(--company)} .company-card .icon,.company-card h4{color:var(--company)}
    .civil-card{border-color:var(--civil)} .civil-card .icon,.civil-card h4{color:var(--civil)}
    .org-card{border-color:var(--org)} .org-card .icon,.org-card h4{color:var(--org)}
    .magazine-card{border-color:var(--magazine)} .magazine-card .icon,.magazine-card h4{color:var(--magazine)}

    /* 당근마켓 카드 */
    .market-cards{display:grid;grid-template-columns:repeat(5,1fr);gap:20px;margin-top:20px}
    .market-card{background:#fff;border-radius:20px;padding:20px;box-shadow:0 6px 16px rgba(0,0,0,.08);text-align:center;transition:transform .25s var(--e), box-shadow .25s var(--e)}
    .market-card:hover{transform:translateY(-6px);box-shadow:0 10px 24px rgba(0,0,0,.12)}
    .market-card h3{margin:0 0 10px;font-size:18px;color:#111827}
    .market-card .id,.market-card .label{font-size:14px;color:#6b7280}
    .market-card .item-name{font-size:20px;font-weight:800;margin:4px 0 14px;color:#111827}
    .market-card .price{display:inline-block;background:#dcfce7;color:#065f46;font-weight:700;font-size:18px;padding:8px 16px;border-radius:50px}

    /* 중앙정렬된 스토리/견적폼 스타일 */
    .story-form, #quoteForm{
      max-width:700px;
      margin:0 auto;
      background:#ffffff;
      border-radius:14px;
      padding:24px;
      box-shadow:0 4px 14px rgba(0,0,0,.06);
    }
    .story-form .row,
    #quoteForm .row {
      display:grid;
      grid-template-columns:140px 1fr;
      gap:10px;
      align-items:center;
      margin-bottom:14px;
    }
    .story-form .row.double{ grid-template-columns:140px 1fr 1fr;}
    @media (max-width: 640px){
      .story-form .row,
      .story-form .row.double,
      #quoteForm .row {
        grid-template-columns:1fr;
      }
    }
    .story-form .row.actions,#quoteForm .row.actions{
      grid-template-columns:1fr;
      text-align:center;
    }
    .story-form label,#quoteForm label{font-weight:800;color:#0f172a;align-self:start;padding-top:2px}
    .story-form input,.story-form textarea,.story-form select,
    #quoteForm input,#quoteForm textarea,#quoteForm select{
      display:block;width:100%;padding:12px;border:1px solid var(--border);border-radius:10px;font-size:15px;background:#fff;line-height:1.5;
    }
    .story-form textarea,#quoteForm textarea{min-height:140px;resize:vertical}

    .btn{display:inline-flex;align-items:center;justify-content:center;gap:8px;padding:11px 16px;border:none;border-radius:10px;background:linear-gradient(135deg,#22c55e,#16a34a);color:#fff;font-weight:900;cursor:pointer;transition:transform .18s var(--e), filter .18s var(--e);box-shadow:0 3px 8px rgba(22,197,94,.25)}
    .btn:hover{filter:brightness(.96); transform:translateY(-2px)}
    .hint{font-size:12.5px; color:#6b7280}

    /* 애니메이션 */
    @keyframes fadeIn{from{opacity:0;transform:translateY(4px)} to{opacity:1;transform:none}}
    @keyframes pageIn{from{opacity:0;transform:translateY(8px)} to{opacity:1;transform:none}}

    #scrollProgress {
      position: fixed; left: 0; top: 0; height: 3px; width: 0%;
      background: linear-gradient(90deg, #22c55e, #86efac);
      z-index: 99999; box-shadow: 0 0 8px rgba(34,197,94,.5);
    }
  </style>
</head>
<body>
  <header><h1 onclick="goHome()">떡잎방범대 정보 센터</h1></header>
  <div id="scrollProgress" aria-hidden="true"></div>

  <div class="layout">
    <!-- 왼쪽 -->
    <aside>
      <div class="aside-box">
        <h3>📢 공지사항</h3>
        <ul>
          <li>떡잎방범대 정보 센터 OPEN</li>
          <li>떡잎방범대 투자 센터 리뉴얼 </li>
          <li>🙏문의: 703 김남정, 디코 dm</li>
        </ul>
      </div>
      <div class="aside-box">
        <h3>🎉 다가오는 이벤트</h3>
        <ul>
          <li> 🎴 작두 호스트바</li>
          <li> 🍀 떡잎방범대 이벤트</li>
          <li> 💍 정부장, 원두 결혼식</li>
        </ul>
      </div>
    </aside>

    <!-- 중앙 -->
    <main>
      <div class="nav-parts">
        <div class="nav-card" onclick="showPage('home')"><div class="icon">🏠</div><h3>홈</h3></div>
        <div class="nav-card" onclick="showPage('market')"><div class="icon">🥕</div><h3>당근마켓</h3></div>
        <div class="nav-card" onclick="showPage('category')"><div class="icon">📂</div><h3>카테고리</h3></div>
        <div class="nav-card" onclick="showPage('stats')"><div class="icon">📈</div><h3>거래 통계</h3></div>
      </div>

      <div class="hero"><h2>📊 정보 센터</h2><p>리얼월드의 아이템 시세와 조직 정보를 한눈에!</p></div>

      <!-- 홈 -->
      <section id="home" class="page active">
        … (여기에 기업/공무원/조직/메거진 카드 전부 그대로 유지 – 파트1 이어서) …

                <!-- 기업 -->
        <div id="company" class="sub-page active">
          <h3>🏢 기업</h3>
          <div class="card-grid">
            <div class="card company-card" onclick="openEntity('company','beehive')">
              <div class="icon">🐝</div><h4>벌집</h4><p>-</p>
            </div>
            <div class="card company-card" onclick="openEntity('company','inback')">
              <div class="icon">🍖</div><h4>InBack</h4><p>-</p>
            </div>
            <div class="card company-card" onclick="openEntity('company','chakani')">
              <div class="icon">🦄</div><h4>차카니</h4><p>-</p>
            </div>
            <div class="card company-card" onclick="openEntity('company','tteokleaf')">
              <div class="icon">🍀</div><h4>떡잎방범대</h4><p>-</p>
            </div>
          </div>
        </div>

        <!-- 공무원 -->
        <div id="civil" class="sub-page">
          <h3>🏛 공무원</h3>
          <div class="card-grid">
            <div class="card civil-card" onclick="openEntity('civil','ems')">
              <div class="icon">🚑</div><h4>EMS</h4><p>-</p>
            </div>
            <div class="card civil-card" onclick="openEntity('civil','southpd')">
              <div class="icon">👮</div><h4>남부경찰</h4><p>-</p>
            </div>
            <div class="card civil-card" onclick="openEntity('civil','northpd')">
              <div class="icon">🚓</div><h4>북부경찰</h4><p>-</p>
            </div>
            <div class="card civil-card" onclick="openEntity('civil','castillo')">
              <div class="icon">🚧</div><h4>카스틸로</h4><p>-</p>
            </div>
            <div class="card civil-card" onclick="openEntity('civil','broadcast')">
              <div class="icon">🌐</div><h4>방송국</h4><p>-</p>
            </div>
          </div>
        </div>

        <!-- 조직 -->
        <div id="org" class="sub-page">
          <h3>👥 조직</h3>
          <div class="card-grid">
            <div class="card org-card" onclick="openEntity('org','bigdick')">
              <div class="icon">🍌</div><h4>빅딕</h4><p>-</p>
            </div>
            <div class="card org-card" onclick="openEntity('org','cheongryong')">
              <div class="icon">💎</div><h4>청룡</h4><p>-</p>
            </div>
            <div class="card org-card" onclick="openEntity('org','sakura')">
              <div class="icon">🌸</div><h4>사쿠라</h4><p>-</p>
            </div>
            <div class="card org-card" onclick="openEntity('org','jakdu')">
              <div class="icon">🎴</div><h4>작두</h4><p>-</p>
            </div>
          </div>
        </div>

        <!-- 메거진 -->
        <div id="magazine" class="sub-page">
          <h3>📰 메거진</h3>
          <div class="card-grid">
            <div class="card magazine-card">
              <div class="icon">🚀</div><h4>미래 기술 트렌드</h4><p>AI, 메타버스, 친환경 산업</p>
            </div>
          </div>
        </div>
      </section>

      <!-- 리얼 방송국 -->
      <div id="broadcastBox">
        <div class="title-row">
          <h2>📡 리얼 방송국</h2>
          <span class="pill">실시간 접수 · 익명 가능</span>
        </div>
        <p class="desc">사연을 보내면 운영진 확인 후 방송으로 소개돼요. <span class="hint">* 로그인 없이 익명 접수 가능</span></p>

        <div class="broadcast-grid">
          <!-- 사연 신청 -->
          <div class="story-card">
            <h3>📝 사연 신청</h3>
            <form id="storyForm" class="story-form" novalidate>
              <div class="row double">
                <label for="storyNick">보내는 분</label>
                <input id="storyNick" type="text" placeholder="닉네임" />
                <input id="storyCode" type="text" placeholder="고번 (예: 251)" />
              </div>
              <div class="row">
                <label for="storyCategory">카테고리</label>
                <select id="storyCategory" required>
                  <option value="" disabled selected>카테고리를 선택하세요</option>
                  <option>연애</option><option>우정</option><option>사건/사고</option><option>일상</option>
                  <option>웃긴 일</option><option>감동</option><option>음악사연</option><option>기타</option>
                </select>
              </div>
              <div class="row">
                <label for="storyTitle">제목</label>
                <input id="storyTitle" type="text" placeholder="사연 제목" maxlength="60" required />
              </div>
              <div class="row">
                <label for="storySong">신청곡</label>
                <input id="storySong" type="text" placeholder="예: 아이유 - 밤편지 (선택)" />
              </div>
              <div class="row" style="align-items:start">
                <label for="storyBody">내용</label>
                <textarea id="storyBody" placeholder="사연 내용을 입력하세요" required></textarea>
              </div>
              <div class="row">
                <label>익명</label>
                <div class="inline">
                  <div id="anonSwitch" class="switch" role="switch" aria-checked="false" tabindex="0"></div>
                  <span class="hint">익명으로 보내기</span>
                </div>
              </div>
              <div class="row actions">
                <button type="submit" class="btn">사연 보내기</button>
              </div>
              <div id="storyMsg" class="hint" style="margin-top:4px" aria-live="polite"></div>
            </form>
          </div>

          <!-- 최신 사연 -->
          <div class="story-list">
            <div class="head">
              <h3>🗂 최신 사연</h3>
              <div class="filters">
                <select id="storyFilter" class="pill">
                  <option value="">전체</option>
                  <option>연애</option><option>우정</option><option>사건/사고</option><option>일상</option>
                  <option>웃긴 일</option><option>감동</option><option>음악사연</option><option>기타</option>
                </select>
              </div>
            </div>
            <ul id="storyList"></ul>
          </div>
        </div>
      </div>

      <!-- 당근마켓 -->
      <section id="market" class="page">
        <div class="section-header" style="justify-content:center;flex-direction:column;align-items:center;text-align:center">
          <h2>🥕 당근마켓</h2>
          <button class="help-pill" onclick="openHelp('market')">당근마켓이란?</button>
        </div>
        <div class="market-cards">
          <div class="market-card"><h3>이름 <span class="id">#고번</span></h3><p class="label">판매물품</p><p class="item-name">달의자</p><div class="price">240억</div></div>
          <div class="market-card"><h3>이름 <span class="id">#고번</span></h3><p class="label">판매물품</p><p class="item-name">테저렉트</p><div class="price">250억</div></div>
          <div class="market-card"><h3>이름 <span class="id">#고번</span></h3><p class="label">판매물품</p><p class="item-name">불손 이펙트</p><div class="price">190억</div></div>
          <div class="market-card"><h3>이름 <span class="id">#고번</span></h3><p class="label">판매물품</p><p class="item-name">브레이크댄스</p><div class="price">12억</div></div>
          <div class="market-card"><h3>이름 <span class="id">#고번</span></h3><p class="label">판매물품</p><p class="item-name">구름의자</p><div class="price">260억</div></div>
        </div>
      </section>

      <!-- 거래 통계 -->
      <section id="stats" class="page">
        <h2>📈 거래 통계</h2>
        <table id="itemTable" style="margin:0 auto;text-align:center;width:80%">
          <thead><tr><th>아이템</th><th>거래량</th><th>평균가</th><th>변동</th></tr></thead>
          <tbody></tbody>
        </table>
      </section>

      <!-- 카테고리 섹션 -->
      <section id="category" class="page">
        <h2 style="text-align:center">📂 카테고리 & 🚗 차량 판매 시세표</h2>

        <!-- 상단 탭 버튼 -->
        <div class="sub-nav">
          <button onclick="showCategoryTab('itemTab')" class="active">📂 카테고리별 시세표</button>
          <button onclick="showCategoryTab('carTab')">🚗 차량 판매 시세표</button>
        </div>

        <!-- 🔹 카테고리별 시세표 탭 -->
        <div id="itemTab" class="cat-tab active" style="max-width:900px;margin:0 auto;text-align:center">
          <h3 id="chair">🪑 의자 종류</h3>
          <table>
            <tr><th>아이템</th><th>시세</th></tr>
            <tr><td>달의자</td><td>230억~250억</td></tr>
            <tr><td>커피의자</td><td>230억~250억</td></tr>
            <tr><td>새장의자</td><td>160억~190억</td></tr>
            <tr><td>구름의자</td><td>270억~300억</td></tr>
          </table>

          <h3 id="support-car">🚗 후원 차량</h3>
          <table>
            <tr><th>아이템</th><th>시세</th></tr>
            <tr><td>M1</td><td>170억~200억</td></tr>
            <tr><td>미니바티</td><td>150억~180억</td></tr>
            <tr><td>이그너스</td><td>245억~270억</td></tr>
            <tr><td>M2</td><td>170억~200억</td></tr>
            <tr><td>시노비</td><td>100억~120억</td></tr>
            <tr><td>네로</td><td>230억~250억</td></tr>
            <tr><td>쇼타로</td><td>80억~100억</td></tr>
            <tr><td>M3</td><td>150억~200억</td></tr>
            <tr><td>테저랙트</td><td>270억~300억</td></tr>
            <tr><td>M4</td><td>170억~200억</td></tr>
            <tr><td>하쿠쵸우</td><td>80억~110억</td></tr>
          </table>

          <h3 id="island-car">🏝 극락도 차량</h3>
          <table>
            <tr><th>아이템</th><th>시세</th></tr>
            <tr><td>바나나카</td><td>60억~80억</td></tr>
            <tr><td>고양카</td><td>70억~100억</td></tr>
            <tr><td>피넛카</td><td>70억~100억</td></tr>
          </table>

          <h3 id="effect">✨ 이펙트</h3>
          <table>
            <tr><th>아이템</th><th>시세</th></tr>
            <tr><td>불손</td><td>220억~270억</td></tr>
            <tr><td>불발</td><td>200억~250억</td></tr>
            <tr><td>리프</td><td>140억~180억</td></tr>
            <tr><td>번개</td><td>130억~150억</td></tr>
            <tr><td>꽃잎비</td><td>250억~280억</td></tr>
          </table>

          <h3 id="skin">🎭 스킨</h3>
          <table>
            <tr><th>아이템</th><th>시세</th></tr>
            <tr><td>다니엘</td><td>200억~240억</td></tr>
            <tr><td>HJ</td><td>150억~200억</td></tr>
            <tr><td>YH</td><td>140억~180억</td></tr>
            <tr><td>다혜</td><td>80억~130억</td></tr>
            <tr><td>유자</td><td>80억~130억</td></tr>
            <tr><td>문신남</td><td>????</td></tr>
            <tr><td>병아리</td><td>150억~180억</td></tr>
            <tr><td>고양이</td><td>150억~180억</td></tr>
          </table>

          <h3 id="dance">💃 행동·댄스·동상</h3>
          <table>
            <tr><th>아이템</th><th>시세</th></tr>
            <tr><td>브레이크댄스</td><td>10억~15억</td></tr>
            <tr><td>오징어댄스</td><td>10억~15억</td></tr>
            <tr><td>브로큰레그</td><td>5억~8억</td></tr>
            <tr><td>마그네틱</td><td>30억~45억</td></tr>
            <tr><td>텔미댄스</td><td>30억~40억</td></tr>
          </table>

          <h3 id="item">✨ 기타 아이템</h3>
          <table>
            <tr><th>아이템</th><th>시세</th></tr>
            <tr><td>롤러</td><td>60억~80억</td></tr>
            <tr><td>펫 입양권</td><td>160억~200억</td></tr>
          </table>
        </div>

        <!-- 🔹 차량 판매 시세표 탭 -->
        <div id="carTab" class="cat-tab" style="max-width:900px;margin:0 auto;text-align:center">
          <h3>🚗 차량 판매 시세표</h3>
          <p class="hint">차량별 상세 정보를 보려면 클릭하세요.</p>

          <div class="car-sale-grid">
            <div class="car-card" data-car="테저랙트">
              <div class="icon">🚀</div>
              <h4>테저랙트</h4>
              <p class="price">300억</p>
            </div>
            <div class="car-card" data-car="네로">
              <div class="icon">🏎️</div>
              <h4>네로</h4>
              <p class="price">250억</p>
            </div>
            <div class="car-card" data-car="M1">
              <div class="icon">🚗</div>
              <h4>M1</h4>
              <p class="price">200억</p>
            </div>
            <div class="car-card" data-car="쇼타로">
              <div class="icon">🏍️</div>
              <h4>쇼타로</h4>
              <p class="price">100억</p>
            </div>
          </div>

                    <!-- 🚗 견적 문의 버튼 -->
          <button class="btn" onclick="openQuoteModal()" style="margin-top:20px">💬 차량 견적 문의</button>
        </div>
      </section>
    </main>

    <!-- 오른쪽 -->
    <aside>
      <h3>🔥 인기 TOP 5</h3>
      <ul id="topList"></ul>
      <h3>⏰ 실시간 알림</h3>
      <ul><li>-</li></ul>
    </aside>
  </div>

  <!-- 엔티티 모달 -->
  <div id="modal" class="modal" aria-hidden="true">
    <div id="modalContent" class="modal-content" role="dialog" aria-modal="true">
      <button class="close-btn" onclick="closeModal()">닫기</button>
      <h3 id="modalTitle"></h3>
      <p id="modalTagline" class="modal-tagline"></p>
      <div class="modal-nav">
        <button data-tab="org" onclick="showModalTab('org')">조직도</button>
        <button data-tab="products" onclick="showModalTab('products')">판매물품</button>
        <button data-tab="info" onclick="showModalTab('info')">기업정보</button>
      </div>
      <div id="modal-org" class="modal-tab">
        <ul id="modalOrgList" class="org-list"></ul>
      </div>
      <div id="modal-products" class="modal-tab">
        <ul id="modalProdList"></ul>
      </div>
      <div id="modal-info" class="modal-tab"><p id="modalInfoText"></p></div>
    </div>
  </div>

  <!-- 스토리 상세 모달 -->
  <div id="storyModal" class="modal" aria-hidden="true">
    <div class="modal-content bg-broadcast" role="dialog" aria-modal="true">
      <button class="close-btn" onclick="closeStory()">닫기</button>
      <h3 id="sModalTitle">사연 제목</h3>
      <p class="modal-tagline" id="sModalMeta">작성자 · 시간</p>
      <div class="help-body">
        <div class="help-view" id="sModalBody" style="white-space:pre-wrap"></div>
        <div style="margin-top:10px;display:flex;gap:8px;flex-wrap:wrap">
          <span class="badge" id="sModalCat">카테고리</span>
          <span class="badge" id="sModalSong" style="display:none"></span>
        </div>
      </div>
    </div>
  </div>

  <!-- 도움말 모달 -->
  <div id="helpModal" class="modal" aria-hidden="true">
    <div class="modal-content" role="dialog" aria-modal="true">
      <button class="close-btn" onclick="closeHelp()">닫기</button>
      <h3 id="helpTitle">도움말</h3>
      <p class="modal-tagline" id="helpTagline">안내</p>
      <div class="help-body">
        <div id="helpContent" class="help-view"></div>
      </div>
    </div>
  </div>

  <!-- 차량 상세 모달 -->
  <div id="carModal" class="modal" aria-hidden="true">
    <div class="modal-content" role="dialog" aria-modal="true">
      <button class="close-btn" onclick="closeCarModal()">닫기</button>
      <h3 id="carModalTitle">차량명</h3>
      <p id="carModalPrice" class="modal-tagline">가격 정보</p>
      <div id="carModalDesc" style="line-height:1.8">세부 설명이 여기에 표시됩니다.</div>
    </div>
  </div>

  <!-- 🚗 견적 문의 모달 -->
  <div id="quoteModal" class="modal" aria-hidden="true">
    <div class="modal-content" role="dialog" aria-modal="true">
      <button class="close-btn" onclick="closeQuoteModal()">닫기</button>
      <h3>🚗 차량 견적 문의</h3>
      <p class="modal-tagline">이름, 고번, 원하는 차량 특징 등을 입력해 주세요.</p>
      <form id="quoteForm" class="story-form" novalidate>
        <div class="row">
          <label for="quoteName">이름</label>
          <input id="quoteName" type="text" placeholder="이름" required />
        </div>
        <div class="row">
          <label for="quoteCode">고번</label>
          <input id="quoteCode" type="text" placeholder="고번 (예: 251)" required />
        </div>
        <div class="row">
          <label for="quoteFeature">원하는 차량 특징</label>
          <textarea id="quoteFeature" placeholder="예: 전자식 서스펜션, 빨간색, 최고속 중요" required></textarea>
        </div>
        <div class="row actions">
          <button type="submit" class="btn">견적 문의 보내기</button>
        </div>
        <div id="quoteMsg" class="hint" style="margin-top:4px" aria-live="polite"></div>
      </form>
    </div>
  </div>

  <!-- ================== 기본 JS ================== -->
  <script>
    /* ---------- 네비 ---------- */
    function showPage(pageId){
      document.querySelectorAll('.page').forEach(s=>s.classList.remove('active'));
      const el=document.getElementById(pageId);
      if(el){ el.classList.add('active'); window.scrollTo({top:0,behavior:'smooth'}); }
      toggleBroadcastBox();
    }
    function goHome(){ showPage('home'); }
    function showSubPage(id){
      document.querySelectorAll('#home .sub-page').forEach(div=>div.classList.remove('active'));
      document.getElementById(id).classList.add('active');
      // 버튼 active
      const buttons = document.querySelectorAll('#home .sub-nav button');
      buttons.forEach(b=>b.classList.remove('active'));
      const order = ['company','civil','org','magazine'];
      const idx = order.indexOf(id);
      if(idx>=0) buttons[idx].classList.add('active');
    }

    function toggleBroadcastBox(){
      const isHome = document.getElementById('home')?.classList.contains('active');
      const bx = document.getElementById('broadcastBox');
      if(bx) bx.style.display = isHome ? '' : 'none';
    }

    /* ---------- 카테고리 탭 ---------- */
    function showCategoryTab(id){
      document.querySelectorAll('.cat-tab').forEach(tab=>tab.classList.remove('active'));
      document.getElementById(id).classList.add('active');
      const buttons = document.querySelectorAll('#category .sub-nav button');
      buttons.forEach(btn=>btn.classList.remove('active'));
      if(id==='itemTab') buttons[0].classList.add('active');
      if(id==='carTab') buttons[1].classList.add('active');
      window.scrollTo({top:0,behavior:'smooth'});
    }

    /* ---------- 퀵 이동 ---------- */
    function scrollToSection(id){
      const el=document.getElementById(id);
      if(el) el.scrollIntoView({behavior:"smooth",block:"start"});
    }

    /* ---------- 거래 통계/인기 TOP5 ---------- */
    const items=[{name:"펫 입양권",volume:0,price:200,change:0}];
    function renderTable(){
      const tbody=document.querySelector("#itemTable tbody");
      if(!tbody) return;
      tbody.innerHTML="";
      items.forEach(it=>{
        const cls=it.change>0?"up":it.change<0?"down":"";
        tbody.innerHTML+=`
          <tr>
            <td>${it.name}</td>
            <td>${it.volume}</td>
            <td>${it.price}억</td>
            <td class="${cls}">${it.change>0?"▲":it.change<0?"▼":"-"} ${it.change}%</td>
          </tr>`;
      });
    }
    function renderTop(){
      const ul=document.querySelector("#topList");
      if(!ul) return;
      ul.innerHTML=items.slice().sort((a,b)=>b.volume-a.volume).slice(0,5)
        .map(it=>`<li>${it.name} (${it.volume}건)</li>`).join("");
    }

    /* ---------- 모달 ---------- */
    function formatOrg(lines){
      return (lines||[]).map(raw=>{
        const t=(raw??"").trim();
        if(!t) return `<li class="org-gap"></li>`;
        if(/^<strong/i.test(t)) return `<li class="org-title">${t}</li>`;
        if(/^\[.*\]$/.test(t)) {
          const label=t.replace(/^\[|\]$/g,"");
          return `<li class="org-section"><span>${label}</span></li>`;
        }
        if(t.includes("총 인원") || t.includes("총원")) {
          return `<li class="org-total">${t}</li>`;
        }
        return `<li class="org-item"><span class="dot"></span>${t}</li>`;
      }).join("");
    }

    const KEY_TO_BG = {
      beehive:'bg-beehive', tteokleaf:'bg-tteok-green', inback:'bg-inback', chakani:'bg-chakani',
      ems:'bg-ems', southpd:'bg-southpd', northpd:'bg-northpd', castillo:'bg-castillo', broadcast:'bg-broadcast',
      bigdick:'bg-bigdick', cheongryong:'bg-cheongryong', sakura:'bg-sakura', jakdu:'bg-jakdu'
    };

    function openEntity(type,key){
      const ent = ENTITIES[type]?.[key];
      if(!ent) return;
      const content=document.getElementById("modalContent");
      content.className = "modal-content " + (KEY_TO_BG[key] || "");
      document.getElementById("modalTitle").textContent=ent.name;
      document.getElementById("modalTagline").textContent = ent.tagline || "—";
      document.querySelectorAll('.modal-tab').forEach(t=>t.classList.remove('active'));
      document.getElementById("modal-org").classList.add('active');
      document.getElementById("modalOrgList").innerHTML = (ent.org && ent.org.length)
        ? formatOrg(ent.org)
        : "<li class='org-item'><span class='dot'></span>등록된 조직도 정보가 없습니다.</li>";
      const prodUL = document.getElementById("modalProdList");
      const hasProducts = Array.isArray(ent.products) && ent.products.length > 0;
      if (hasProducts) {
        prodUL.innerHTML = ent.products.map((p, i) => {
          const delay = i * 40;
          const note = p.note ? `<div class="prod-note">${p.note}</div>` : "";
          return `
            <li class="prod-card" style="animation-delay:${delay}ms">
              <div class="prod-title">${p.name}</div>
              <div class="prod-price">${p.price}</div>
              ${note}
            </li>`;
        }).join("");
      } else { prodUL.innerHTML = ""; }
      document.getElementById("modalInfoText").innerHTML=`<b>한 마디:</b> ${ent.tagline||"—"}<br>${ent.info||""}`;
      const btnProducts = document.querySelector('.modal-nav button[data-tab="products"]');
      btnProducts.style.display = hasProducts ? '' : 'none';
      const modal=document.getElementById("modal");
      modal.classList.add('show');document.body.style.overflow='hidden';modal.setAttribute('aria-hidden','false');
    }
    function closeModal(){
      document.getElementById("modal").classList.remove('show');
      document.body.style.overflow = '';
      document.getElementById("modal").setAttribute('aria-hidden','true');
    }
    function showModalTab(id){
      document.querySelectorAll('.modal-tab').forEach(t=>t.classList.remove('active'));
      document.getElementById("modal-"+id).classList.add('active');
    }

    /* ---------- 도움말 ---------- */
    const HELP_TEXTS = {
      market: `<ul><li><b>당근마켓</b>은 개인 간 아이템 거래를 위한 커뮤니티 장터입니다.</li><li>703 김남정 디스코드 DM으로 문의하세요.</li></ul>`
    };
    function openHelp(key){
      const modal = document.getElementById('helpModal');
      const title = document.getElementById('helpTitle');
      const tagline = document.getElementById('helpTagline');
      const content = document.getElementById('helpContent');
      if(key==='market'){title.textContent='당근마켓 도움말';tagline.textContent='커뮤니티 장터 이용 안내';}
      else{title.textContent='도움말';tagline.textContent='안내';}
      content.innerHTML = HELP_TEXTS[key] || '<p class="help-view">안내가 없습니다.</p>';
      modal.classList.add('show');modal.setAttribute('aria-hidden','false');document.body.style.overflow='hidden';
    }
    function closeHelp(){
      const modal = document.getElementById('helpModal');
      modal.classList.remove('show');modal.setAttribute('aria-hidden','true');document.body.style.overflow='';
    }

    /* ---------- 스토리(방송국) ---------- */
    window.storyMap = new Map();
    function openStory(id){
      const s = window.storyMap.get(id); if(!s) return;
      document.getElementById('sModalTitle').textContent = s.title || '(제목 없음)';
      const nameStr = s.isAnon ? '익명' : (s.nick || '—');
      const codeStr = (!s.isAnon && s.code) ? ` (${s.code})` : '';
      document.getElementById('sModalMeta').textContent = `${nameStr}${codeStr} · ${s._time || ''}`;
      document.getElementById('sModalBody').textContent = s.body || '';
      const cat = document.getElementById('sModalCat');cat.textContent = s.category || '기타';
      const song = document.getElementById('sModalSong');
      if(s.song){ song.style.display='inline-flex'; song.textContent = `🎵 ${s.song}`; } else { song.style.display='none'; }
      const m = document.getElementById('storyModal');m.classList.add('show');m.setAttribute('aria-hidden','false');document.body.style.overflow='hidden';
    }
    function closeStory(){
      const m = document.getElementById('storyModal');
      m.classList.remove('show');m.setAttribute('aria-hidden','true');document.body.style.overflow='';
    }

    /* ---------- 차량 모달 & 견적 ---------- */
    function openCarModal(name, price, desc){
      document.getElementById('carModalTitle').textContent = name || '차량명';
      document.getElementById('carModalPrice').textContent = price || '가격 정보';
      document.getElementById('carModalDesc').textContent = desc || '세부 설명이 여기에 표시됩니다.';
      const m = document.getElementById('carModal');
      m.classList.add('show');m.setAttribute('aria-hidden','false');document.body.style.overflow='hidden';
    }
    function closeCarModal(){
      const m = document.getElementById('carModal');
      m.classList.remove('show');m.setAttribute('aria-hidden','true');document.body.style.overflow='';
    }

    function openQuoteModal(){
      const m=document.getElementById('quoteModal');
      m.classList.add('show');m.setAttribute('aria-hidden','false');document.body.style.overflow='hidden';
    }
    function closeQuoteModal(){
      const m=document.getElementById('quoteModal');
      m.classList.remove('show');m.setAttribute('aria-hidden','true');document.body.style.overflow='';
    }

    // 견적 폼 처리
    const quoteForm = document.getElementById('quoteForm');
    const quoteMsg  = document.getElementById('quoteMsg');
    quoteForm?.addEventListener('submit',(e)=>{
      e.preventDefault();
      const name=document.getElementById('quoteName').value.trim();
      const code=document.getElementById('quoteCode').value.trim();
      const feat=document.getElementById('quoteFeature').value.trim();
      if(!name||!code||!feat){
        quoteMsg.textContent='모든 항목을 입력해주세요.';quoteMsg.style.color='#dc2626';return;
      }
      quoteMsg.textContent='전송 중...';quoteMsg.style.color='#6b7280';
      setTimeout(()=>{quoteMsg.textContent='견적 문의가 접수되었습니다!';quoteMsg.style.color='#16a34a';quoteForm.reset();},800);
    });

    /* ---------- 차량카드 클릭 이벤트 ---------- */
    document.addEventListener('click',function(e){
      const carCard=e.target.closest('.car-card');
      if(carCard){
        const name=carCard.querySelector('h4')?.textContent||'차량명';
        const price=carCard.querySelector('.price')?.textContent||'가격정보';
        openCarModal(name,price,'세부 설명이 곧 추가될 예정입니다.');
      }
    });

    /* ---------- 스크롤 프로그레스 ---------- */
    window.addEventListener('scroll',()=>{
      const winScroll=document.body.scrollTop||document.documentElement.scrollTop;
      const height=document.documentElement.scrollHeight-document.documentElement.clientHeight;
      const scrolled=(winScroll/height)*100;
      document.getElementById("scrollProgress").style.width=scrolled+"%";
    });

    /* ---------- 초기 렌더 ---------- */
    document.addEventListener('DOMContentLoaded',()=>{
      renderTable();
      renderTop();
      toggleBroadcastBox();
    });
  </script>
</body>
</html>
