<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>떡잎방범대 정보 센터</title>
  <style>
    :root{
      --card:#ffffff; --ink:#0f172a; --muted:#475569; --accent:#22c55e; --border:#e5e7eb;
      --company:#3b82f6; --civil:#16a34a; --org:#8b5cf6; --magazine:#f97316;
      --up:#16a34a; --down:#dc2626; --e:cubic-bezier(.22,.9,.24,1);
    }

    /* 전역 */
    html { box-sizing: border-box; font-size:17px; overflow-y:scroll; }
    *, *::before, *::after { box-sizing: inherit; }
    body{
      margin:0;
      font-family:"Noto Sans KR",system-ui,-apple-system,Segoe UI,Roboto,sans-serif;
      color:var(--ink);
      background:#f0fdf4;
      line-height:1.6
    }

    /* 헤더 */
    header{
      background:#fff;
      border-bottom:1px solid var(--border);
      padding:20px;
      text-align:center;
      box-shadow:0 2px 6px rgba(0,0,0,.05)
    }
    header h1{
      margin:0;
      font-size:30px;
      color:var(--accent);
      font-weight:900;
      cursor:pointer;
      transition:transform .2s var(--e)
    }
    header h1:hover{transform:scale(1.02)}

    /* 레이아웃 */
    .layout{
      display:grid;
      grid-template-columns:300px 1fr 300px;
      column-gap:40px;row-gap:24px;
      max-width:1600px;margin:20px auto;
      padding:0 30px
    }
    main{display:flex;flex-direction:column;gap:20px}

    /* 좌우 사이드 공통 */
    aside{
      background:var(--card);
      border-radius:14px;
      padding:20px;
      box-shadow:0 4px 12px rgba(0,0,0,.06);
      position:sticky;top:20px;height:500px;overflow-y:auto
    }
    aside h3{
      margin:0 0 12px;
      color:var(--accent);
      font-size:16px;font-weight:700
    }
    aside ul{margin:0;padding-left:18px}
    aside li{margin-bottom:6px}
    .aside-box{
      margin-bottom:20px;
      padding:12px;
      border-radius:10px;
      background:#fff
    }
    .aside-box h3{
      margin:0 0 10px;font-size:16px;font-weight:700;color:var(--accent)
    }

    /* 히어로 */
    .hero{
      text-align:center;
      padding:40px;
      border-radius:16px;
      background:linear-gradient(135deg,#bbf7d0,#ecfdf5);
      box-shadow:0 6px 16px rgba(0,0,0,.08);
      margin:20px 0;
      animation:fadeIn .35s var(--e)
    }
    .hero h2{margin:0 0 14px;color:var(--accent);font-size:26px;font-weight:800}
    .hero p{font-size:16px;color:#374151}

    /* 상단 네비 카드 */
    .nav-parts{
      display:flex;justify-content:center;gap:24px;
      margin:20px auto;flex-wrap:wrap
    }
    .nav-card{
      flex:1;min-width:150px;max-width:200px;
      background:linear-gradient(135deg,#dcfce7,#f0fdf4);
      padding:22px 16px;text-align:center;border-radius:16px;
      box-shadow:0 6px 14px rgba(0,0,0,.08);
      cursor:pointer;
      transition:transform .25s var(--e), box-shadow .25s var(--e)
    }
    .nav-card:hover{transform:translateY(-6px);box-shadow:0 10px 24px rgba(0,0,0,.12)}
    .nav-card .icon{font-size:28px;margin-bottom:10px}
    .nav-card h3{margin:0;font-size:18px;color:var(--accent);font-weight:700}

    /* 페이지 공통 */
    section.page{
      display:none;padding:28px;background:var(--card);
      border-radius:14px;box-shadow:0 4px 12px rgba(0,0,0,.05)
    }
    section.page.active{display:block;animation:pageIn .28s var(--e)}
    section h2{margin:0 0 16px;color:var(--accent);font-size:21px;font-weight:700}

    /* 애니메이션 */
    @keyframes fadeIn{from{opacity:0;transform:translateY(4px)} to{opacity:1;transform:none}}
    @keyframes pageIn{from{opacity:0;transform:translateY(8px)} to{opacity:1;transform:none}}
    @media (prefers-reduced-motion: reduce){ *{animation:none !important; transition:none !important} }

    /* 스크롤 진행바 */
    #scrollProgress {
      position: fixed; left: 0; top: 0; height: 3px; width: 0%;
      background: linear-gradient(90deg, #22c55e, #86efac);
      z-index: 99999; box-shadow: 0 0 8px rgba(34,197,94,.5);
    }
  </style>
</head>
<body>
  <header><h1 onclick="goHome()">떡잎방범대 정보 센터</h1></header>
  <div id="scrollProgress" aria-hidden="true"></div>

  <div class="layout">
    <!-- 왼쪽 사이드 -->
    <aside>
      <div class="aside-box">
        <h3>📢 공지사항</h3>
        <ul>
          <li>떡잎방범대 정보 센터 OPEN</li>
          <li>떡잎방범대 투자 센터 리뉴얼 </li>
          <li>🙏문의: 703 김남정, 디코 dm</li>
        </ul>
      </div>
      <div class="aside-box">
        <h3>🎉 다가오는 이벤트</h3>
        <ul>
          <li> 🎴 작두 호스트바</li>
          <li> 🍀 떡잎방범대 이벤트</li>
          <li> 💍 정부장, 원두 결혼식</li>
        </ul>
      </div>
    </aside>

    <!-- 중앙 컨텐츠 시작 -->
    <main>
      <div class="nav-parts">
        <div class="nav-card" onclick="showPage('home')"><div class="icon">🏠</div><h3>홈</h3></div>
        <div class="nav-card" onclick="showPage('market')"><div class="icon">📚</div><h3>카탈로그</h3></div>
        <div class="nav-card" onclick="showPage('category')"><div class="icon">📂</div><h3>카테고리</h3></div>
        <div class="nav-card" onclick="showPage('stats')"><div class="icon">📈</div><h3>거래 통계</h3></div>
      </div>

      <div class="hero"><h2>📊 정보 센터</h2><p>리얼월드의 아이템 시세와 조직 정보를 한눈에!</p></div>

            <!-- 홈 -->
      <section id="home" class="page active">
        <h2>🏠 홈</h2>
        <div class="sub-nav">
          <button onclick="showSubPage('company')">기업</button>
          <button onclick="showSubPage('civil')">공무원</button>
          <button onclick="showSubPage('org')">조직</button>
          <button onclick="showSubPage('magazine')">메거진</button>
        </div>

        <!-- 기업 -->
        <div id="company" class="sub-page active">
          <h3>🏢 기업</h3>
          <div class="card-grid">
            <div class="card company-card" onclick="openEntity('company','beehive')">
              <div class="icon">🐝</div><h4>벌집</h4><p>-</p>
            </div>
            <div class="card company-card" onclick="openEntity('company','inback')">
              <div class="icon">🍖</div><h4>InBack</h4><p>-</p>
            </div>
            <div class="card company-card" onclick="openEntity('company','chakani')">
              <div class="icon">🦄</div><h4>차카니</h4><p>-</p>
            </div>
            <div class="card company-card" onclick="openEntity('company','tteokleaf')">
              <div class="icon">🍀</div><h4>떡잎방범대</h4><p>-</p>
            </div>
          </div>
        </div>

        <!-- 공무원 -->
        <div id="civil" class="sub-page">
          <h3>🏛 공무원</h3>
          <div class="card-grid">
            <div class="card civil-card" onclick="openEntity('civil','ems')">
              <div class="icon">🚑</div><h4>EMS</h4><p>-</p>
            </div>
            <div class="card civil-card" onclick="openEntity('civil','southpd')">
              <div class="icon">👮</div><h4>남부경찰</h4><p>-</p>
            </div>
            <div class="card civil-card" onclick="openEntity('civil','northpd')">
              <div class="icon">🚓</div><h4>북부경찰</h4><p>-</p>
            </div>
            <div class="card civil-card" onclick="openEntity('civil','castillo')">
              <div class="icon">🚧</div><h4>카스틸로</h4><p>-</p>
            </div>
            <div class="card civil-card" onclick="openEntity('civil','broadcast')">
              <div class="icon">🌐</div><h4>방송국</h4><p>-</p>
            </div>
          </div>
        </div>

        <!-- 조직 -->
        <div id="org" class="sub-page">
          <h3>👥 조직</h3>
          <div class="card-grid">
            <div class="card org-card" onclick="openEntity('org','bigdick')">
              <div class="icon">🍌</div><h4>빅딕</h4><p>-</p>
            </div>
            <div class="card org-card" onclick="openEntity('org','cheongryong')">
              <div class="icon">💎</div><h4>청룡</h4><p>-</p>
            </div>
            <div class="card org-card" onclick="openEntity('org','sakura')">
              <div class="icon">🌸</div><h4>사쿠라</h4><p>-</p>
            </div>
            <div class="card org-card" onclick="openEntity('org','jakdu')">
              <div class="icon">🎴</div><h4>작두</h4><p>-</p>
            </div>
          </div>
        </div>

        <!-- 메거진 -->
        <div id="magazine" class="sub-page">
          <h3>📰 메거진</h3>
          <div class="card-grid">
            <div class="card magazine-card">
              <div class="icon">🚀</div><h4>미래 기술 트렌드</h4><p>AI, 메타버스, 친환경 산업</p>
            </div>
          </div>
        </div>
      </section>

      <!-- 리얼 방송국 (홈 섹션 바로 아래, 같은 폭) -->
      <div id="broadcastBox">
        <div class="title-row">
          <h2>📡 리얼 방송국</h2>
          <span class="pill">실시간 접수 · 익명 가능</span>
        </div>
        <p class="desc">사연을 보내면 운영진 확인 후 방송으로 소개돼요. <span class="hint">* 로그인 없이 익명 접수 가능</span></p>

        <div class="broadcast-grid">
          <!-- 사연 신청 -->
          <div class="story-card">
            <h3>📝 사연 신청</h3>
            <form id="storyForm" class="story-form" novalidate>
              <div class="row double">
                <label for="storyNick">보내는 분</label>
                <input id="storyNick" type="text" placeholder="닉네임" />
                <input id="storyCode" type="text" placeholder="고번 (예: 251)" />
              </div>

              <div class="row">
                <label for="storyCategory">카테고리</label>
                <select id="storyCategory" required>
                  <option value="" disabled selected>카테고리를 선택하세요</option>
                  <option>연애</option><option>우정</option><option>사건/사고</option><option>일상</option>
                  <option>웃긴 일</option><option>감동</option><option>음악사연</option><option>기타</option>
                </select>
              </div>

              <div class="row">
                <label for="storyTitle">제목</label>
                <input id="storyTitle" type="text" placeholder="사연 제목" maxlength="60" required />
              </div>

              <div class="row">
                <label for="storySong">신청곡</label>
                <input id="storySong" type="text" placeholder="예: 아이유 - 밤편지 (선택)" />
              </div>

              <div class="row" style="align-items:start">
                <label for="storyBody">내용</label>
                <textarea id="storyBody" placeholder="사연 내용을 입력하세요" required></textarea>
              </div>

              <div class="row">
                <label>익명</label>
                <div class="inline">
                  <div id="anonSwitch" class="switch" role="switch" aria-checked="false" tabindex="0"></div>
                  <span class="hint">익명으로 보내기</span>
                </div>
              </div>

              <div class="row actions">
                <button type="submit" class="btn">사연 보내기</button>
              </div>
              <div id="storyMsg" class="hint" style="margin-top:4px" aria-live="polite"></div>
            </form>
          </div>

          <!-- 최신 사연 -->
          <div class="story-list">
            <div class="head">
              <h3>🗂 최신 사연</h3>
              <div class="filters">
                <select id="storyFilter" class="pill">
                  <option value="">전체</option>
                  <option>연애</option><option>우정</option><option>사건/사고</option><option>일상</option>
                  <option>웃긴 일</option><option>감동</option><option>음악사연</option><option>기타</option>
                </select>
              </div>
            </div>
            <ul id="storyList"></ul>
          </div>
        </div>
      </div>
      <!-- /리얼 방송국 -->

            <!-- 카탈로그 -->
      <section id="market" class="page">
        <div class="section-header">
          <h2>📚 카탈로그</h2>
          <button class="help-pill" onclick="openHelp('market')">카탈로그 안내</button>
        </div>

        <!-- 오프로드 -->
        <h3>🚙 오프로드</h3>
        <div class="market-cards">
          <div class="market-card"><p class="item-name">디로더</p><div class="price">1,650,000,000원</div></div>
          <div class="market-card"><p class="item-name">에버온</p><div class="price">1,650,000,000원</div></div>
          <div class="market-card"><p class="item-name">요세미터3</p><div class="price">1,650,000,000원</div></div>
          <div class="market-card"><p class="item-name">메사</p><div class="price">1,782,000,000원</div></div>
          <div class="market-card"><p class="item-name">듀브스타</p><div class="price">2,794,000,000원</div></div>
          <div class="market-card"><p class="item-name">프리크롤러</p><div class="price">4,037,000,000원</div></div>
        </div>

        <!-- 머슬카 -->
        <h3>💪 머슬카</h3>
        <div class="market-cards">
          <div class="market-card"><p class="item-name">탐파2</p><div class="price">3,124,000,000원</div></div>
        </div>

        <!-- 밴 -->
        <h3>🚐 밴</h3>
        <div class="market-cards">
          <div class="market-card"><p class="item-name">반캣XL</p><div class="price">1,650,000,000원</div></div>
          <div class="market-card"><p class="item-name">부리토</p><div class="price">1,650,000,000원</div></div>
          <div class="market-card"><p class="item-name">서버</p><div class="price">2,882,000,000원</div></div>
        </div>

        <!-- 스포츠카 -->
        <h3>🏎️ 스포츠카</h3>
        <div class="market-cards">
          <div class="market-card"><p class="item-name">엘리지2</p><div class="price">1,672,000,000원</div></div>
          <div class="market-card"><p class="item-name">코그브리오</p><div class="price">1,848,000,000원</div></div>
          <div class="market-card"><p class="item-name">재칼</p><div class="price">1,914,000,000원</div></div>
          <div class="market-card"><p class="item-name">미쉘리</p><div class="price">1,925,000,000원</div></div>
          <div class="market-card"><p class="item-name">버팔로</p><div class="price">1,980,000,000원</div></div>
          <div class="market-card"><p class="item-name">버팔로2</p><div class="price">2,002,000,000원</div></div>
          <div class="market-card"><p class="item-name">버팔로3</p><div class="price">2,024,000,000원</div></div>
          <div class="market-card"><p class="item-name">GB200</p><div class="price">1,848,000,000원</div></div>
          <div class="market-card"><p class="item-name">재스터3</p><div class="price">2,090,000,000원</div></div>
          <div class="market-card"><p class="item-name">마사크로</p><div class="price">2,112,000,000원</div></div>
          <div class="market-card"><p class="item-name">마사크로2</p><div class="price">2,134,000,000원</div></div>
          <div class="market-card"><p class="item-name">베스트아GTS</p><div class="price">2,772,000,000원</div></div>
          <div class="market-card"><p class="item-name">펠론</p><div class="price">2,860,000,000원</div></div>
          <div class="market-card"><p class="item-name">트로포스</p><div class="price">2,926,000,000원</div></div>
          <div class="market-card"><p class="item-name">슬라겐</p><div class="price">3,168,000,000원</div></div>
          <div class="market-card"><p class="item-name">코멧3</p><div class="price">3,190,000,000원</div></div>
          <div class="market-card"><p class="item-name">백트레</p><div class="price">3,212,000,000원</div></div>
          <div class="market-card"><p class="item-name">드래프터</p><div class="price">3,234,000,000원</div></div>
          <div class="market-card"><p class="item-name">주글러</p><div class="price">3,256,000,000원</div></div>
          <div class="market-card"><p class="item-name">팡테르</p><div class="price">4,070,000,000원</div></div>
          <div class="market-card"><p class="item-name">펠른2</p><div class="price">4,103,000,000원</div></div>
          <div class="market-card"><p class="item-name">파리아</p><div class="price">4,169,000,000원</div></div>
          <div class="market-card"><p class="item-name">네온</p><div class="price">4,367,000,000원</div></div>
        </div>

        <!-- 클래식 -->
        <h3>🎩 클래식</h3>
        <div class="market-cards">
          <div class="market-card"><p class="item-name">토르네이도</p><div class="price">1,716,000,000원</div></div>
          <div class="market-card"><p class="item-name">토나도5</p><div class="price">1,738,000,000원</div></div>
          <div class="market-card"><p class="item-name">토네이도6</p><div class="price">1,760,000,000원</div></div>
          <div class="market-card"><p class="item-name">디이너스티</p><div class="price">1,936,000,000원</div></div>
          <div class="market-card"><p class="item-name">Z190</p><div class="price">2,068,000,000원</div></div>
          <div class="market-card"><p class="item-name">GT500</p><div class="price">2,156,000,000원</div></div>
          <div class="market-card"><p class="item-name">코켓2</p><div class="price">2,178,000,000원</div></div>
          <div class="market-card"><p class="item-name">코켓5</p><div class="price">2,200,000,000원</div></div>
          <div class="market-card"><p class="item-name">인퍼너스2</p><div class="price">2,838,000,000원</div></div>
        </div>

        <!-- 세단 -->
        <h3>🚗 세단</h3>
        <div class="market-cards">
          <div class="market-card"><p class="item-name">콕55</p><div class="price">1,694,000,000원</div></div>
          <div class="market-card"><p class="item-name">스태포드</p><div class="price">1,870,000,000원</div></div>
          <div class="market-card"><p class="item-name">라인하트</p><div class="price">3,080,000,000원</div></div>
          <div class="market-card"><p class="item-name">친퀘밀라</p><div class="price">4,301,000,000원</div></div>
        </div>

        <!-- 슈퍼카 -->
        <h3>🏎️ 슈퍼카</h3>
        <div class="market-cards">
          <div class="market-card"><p class="item-name">페네트레이터</p><div class="price">2,948,000,000원</div></div>
          <div class="market-card"><p class="item-name">GP1</p><div class="price">3,278,000,000원</div></div>
          <div class="market-card"><p class="item-name">치타2</p><div class="price">3,300,000,000원</div></div>
          <div class="market-card"><p class="item-name">몰릭</p><div class="price">4,202,000,000원</div></div>
          <div class="market-card"><p class="item-name">바카</p><div class="price">4,235,000,000원</div></div>
          <div class="market-card"><p class="item-name">인퍼너스</p><div class="price">4,334,000,000원</div></div>
          <div class="market-card"><p class="item-name">반시2</p><div class="price">4,400,000,000원</div></div>
        </div>

        <!-- SUV -->
        <h3>🚙 SUV</h3>
        <div class="market-cards">
          <div class="market-card"><p class="item-name">그레슬리</p><div class="price">1,804,000,000원</div></div>
          <div class="market-card"><p class="item-name">FQ2</p><div class="price">1,826,000,000원</div></div>
          <div class="market-card"><p class="item-name">힌틀리</p><div class="price">1,892,000,000원</div></div>
          <div class="market-card"><p class="item-name">더브스타2</p><div class="price">2,816,000,000원</div></div>
          <div class="market-card"><p class="item-name">이시8</p><div class="price">2,970,000,000원</div></div>
          <div class="market-card"><p class="item-name">발러3</p><div class="price">2,992,000,000원</div></div>
          <div class="market-card"><p class="item-name">발러4</p><div class="price">3,014,000,000원</div></div>
          <div class="market-card"><p class="item-name">발러7</p><div class="price">3,036,000,000원</div></div>
          <div class="market-card"><p class="item-name">핫 링 에바론</p><div class="price">3,058,000,000원</div></div>
          <div class="market-card"><p class="item-name">노박</p><div class="price">3,102,000,000원</div></div>
          <div class="market-card"><p class="item-name">비반나이트</p><div class="price">4,136,000,000원</div></div>
          <div class="market-card"><p class="item-name">에스트론</p><div class="price">4,268,000,000원</div></div>
          <div class="market-card"><p class="item-name">하바네로</p><div class="price">5,500,000,000원</div></div>
        </div>

        <!-- 소형 -->
        <h3>🚗 소형</h3>
        <div class="market-cards">
          <div class="market-card"><p class="item-name">이씨클래식</p><div class="price">1,650,000,000원</div></div>
          <div class="market-card"><p class="item-name">브리오소</p><div class="price">2,904,000,000원</div></div>
        </div>
      </section>

            <!-- 카테고리 -->
      <section id="category" class="page">
        <h2>📂 카테고리별 시세표</h2>
        <div class="quick-nav">
          <button onclick="scrollToSection('chair')">🪑 의자 종류</button>
          <button onclick="scrollToSection('support-car')">🚗 후원 차량</button>
          <button onclick="scrollToSection('island-car')">🏝 극락도 차량</button>
          <button onclick="scrollToSection('effect')">✨ 이펙트</button>
          <button onclick="scrollToSection('skin')">🎭 스킨</button>
          <button onclick="scrollToSection('dance')">💃 행동·댄스·동상</button>
          <button onclick="scrollToSection('item')">✨ 기타</button>
          <button onclick="scrollToSection('car-sale')">🚗 차량 판매 시세표</button>
        </div>

        <h3 id="chair">🪑 의자 종류</h3>
        <table>
          <tr><th>아이템</th><th>시세</th></tr>
          <tr><td>달의자</td><td>230억~250억</td></tr>
          <tr><td>커피의자</td><td>230억~250억</td></tr>
          <tr><td>새장의자</td><td>160억~190억</td></tr>
          <tr><td>구름의자</td><td>270억~300억</td></tr>
        </table>

        <h3 id="support-car">🚗 후원 차량</h3>
        <table>
          <tr><th>아이템</th><th>시세</th></tr>
          <tr><td>M1</td><td>170억~200억</td></tr>
          <tr><td>미니바티</td><td>150억~180억</td></tr>
          <tr><td>이그너스</td><td>245억~270억</td></tr>
          <tr><td>M2</td><td>170억~200억</td></tr>
          <tr><td>시노비</td><td>100억~120억</td></tr>
          <tr><td>네로</td><td>230억~250억</td></tr>
          <tr><td>쇼타로</td><td>80억~100억</td></tr>
          <tr><td>M3</td><td>150억~200억</td></tr>
          <tr><td>테저랙트</td><td>270억~300억</td></tr>
          <tr><td>M4</td><td>170억~200억</td></tr>
          <tr><td>하쿠쵸우</td><td>80억~110억</td></tr>
        </table>

        <h3 id="island-car">🏝 극락도 차량</h3>
        <table>
          <tr><th>아이템</th><th>시세</th></tr>
          <tr><td>바나나카</td><td>60억~80억</td></tr>
          <tr><td>고양카</td><td>70억~100억</td></tr>
          <tr><td>피넛카</td><td>70억~100억</td></tr>
        </table>

        <h3 id="effect">✨ 이펙트</h3>
        <table>
          <tr><th>아이템</th><th>시세</th></tr>
          <tr><td>불손</td><td>220억~270억</td></tr>
          <tr><td>불발</td><td>200억~250억</td></tr>
          <tr><td>리프</td><td>140억~180억</td></tr>
          <tr><td>번개</td><td>130억~150억</td></tr>
          <tr><td>꽃잎비</td><td>250억~280억</td></tr>
        </table>

        <h3 id="skin">🎭 스킨</h3>
        <table>
          <tr><th>아이템</th><th>시세</th></tr>
          <tr><td>다니엘</td><td>200억~240억</td></tr>
          <tr><td>HJ</td><td>150억~200억</td></tr>
          <tr><td>YH</td><td>140억~180억</td></tr>
          <tr><td>다혜</td><td>80억~130억</td></tr>
          <tr><td>유자</td><td>80억~130억</td></tr>
          <tr><td>문신남</td><td>????</td></tr>
          <tr><td>병아리</td><td>150억~180억</td></tr>
          <tr><td>고양이</td><td>150억~180억</td></tr>
        </table>

        <h3 id="dance">💃 행동·댄스·동상</h3>
        <table>
          <tr><th>아이템</th><th>시세</th></tr>
          <tr><td>브레이크댄스</td><td>10억~15억</td></tr>
          <tr><td>오징어댄스</td><td>10억~15억</td></tr>
          <tr><td>브로큰레그</td><td>5억~8억</td></tr>
          <tr><td>마그네틱</td><td>30억~45억</td></tr>
          <tr><td>텔미댄스</td><td>30억~40억</td></tr>
          <tr><td>버스안에서댄스</td><td>6억~8억</td></tr>
          <tr><td>스마트댄스</td><td>30억~38억</td></tr>
          <tr><td>소다팝댄스</td><td>38억~46억</td></tr>
          <tr><td>팝핀댄스</td><td>5억~10억</td></tr>
          <tr><td>스캇앤젤다댄스</td><td>20억~28억</td></tr>
          <tr><td>뻣뻣로봇댄스</td><td>6억~10억</td></tr>
          <tr><td>골반흔들기</td><td>15억~20억</td></tr>
          <tr><td>크레이지트워킹</td><td>15억~20억</td></tr>
          <tr><td>슬릭백</td><td>18억~27억</td></tr>
          <tr><td>이리와</td><td>5억~8억</td></tr>
          <tr><td>언더더씨</td><td>5억~8억</td></tr>
          <tr><td>쌍뻐큐</td><td>10억~15억</td></tr>
          <tr><td>맘맘</td><td>7억~11억</td></tr>
          <tr><td>회전회오리</td><td>18억~24억</td></tr>
          <tr><td>쏘리댄스</td><td>5억~10억</td></tr>
          <tr><td>하트 동상포즈(남)</td><td>10억~15억</td></tr>
          <tr><td>하트 동상포즈(여)</td><td>11억~16억</td></tr>
          <tr><td>동상포즈(남)</td><td>10억~15억</td></tr>
          <tr><td>동상포즈(여)</td><td>11억~15억</td></tr>
          <tr><td>무릎앉기</td><td>7억~10억</td></tr>
          <tr><td>조신하게 앉기</td><td>8억~10억</td></tr>
          <tr><td>괴속질주</td><td>10억~13억</td></tr>
          <tr><td>흔들어</td><td>15억~18억</td></tr>
          <tr><td>오예스</td><td>9억~15억</td></tr>
          <tr><td>요가포즈</td><td>13억~16억</td></tr>
          <tr><td>냄새나</td><td>10억~15억</td></tr>
          <tr><td>쓰러지기</td><td>5억~7억</td></tr>
          <tr><td>기도하는</td><td>5억~10억</td></tr>
          <tr><td>내빵뎅이</td><td>5억~8억</td></tr>
        </table>

        <h3 id="item">✨ 기타 아이템</h3>
        <table>
          <tr><th>아이템</th><th>시세</th></tr>
          <tr><td>롤러</td><td>60억~80억</td></tr>
          <tr><td>펫 입양권</td><td>160억~200억</td></tr>
        </table>

        <!-- 차량 판매 시세표 -->
        <h3 id="car-sale">🚗 차량 판매 시세표</h3>
        <div class="car-sale-grid">
          <div class="car-card" data-car="테저랙트">
            <h4>테저랙트</h4>
            <p class="price">300억</p>
          </div>
          <div class="car-card" data-car="네로">
            <h4>네로</h4>
            <p class="price">250억</p>
          </div>
          <div class="car-card" data-car="M1">
            <h4>M1</h4>
            <p class="price">200억</p>
          </div>
          <div class="car-card" data-car="쇼타로">
            <h4>쇼타로</h4>
            <p class="price">100억</p>
          </div>
        </div>
      </section>

      <!-- 거래 통계 -->
      <section id="stats" class="page">
        <h2>📈 거래 통계</h2>
        <table id="itemTable">
          <thead><tr><th>아이템</th><th>거래량</th><th>평균가</th><th>변동</th></tr></thead>
          <tbody></tbody>
        </table>
      </section>

        <!-- 기본 JS -->
  <script>
    /* ---------- 데이터 ---------- */
    const ENTITIES = { 
      company:{ 
        beehive:{name:"벌집",tagline:"“ - ”",info:"지역 커뮤니티 기반 정보·거래 허브를 지향합니다.",
          products:[{name:"전투 방탄복", price:"2,000,000원", note:"일일 제한: 최소 10개 ~ 무제한"},{name:"확장 탄창", price:"1,500,000원", note:"일일 제한: 최소 10개 ~ 무제한"},{name:"소음기", price:"1,000,000원", note:"일일 제한: 최소 10개 ~ 무제한"}],
          org:["<strong>벌집 직급표</strong>","","[고위직]","회장(1): 신짱(251)","부회장(1): 빅토르(525)","사장(1): 민돌(545)","부사장(1): 찰리리차드(556)","",
            "[간부직]","전무(2): 마틴(553), 김남정(703)","상무(2): 악마(1025), 길태미(597)","이사(1): 나몽이흙먹지마(958)","",
            "[특수직]","비서(2): 신짱구(1094), 나몽(957)","비서실장(1): 민중(2388)","해외출장파견(1): 투반(459)","",
            "[일반직]","부장(0): 공석","차장(0): 공석","과장(0): 공석","떡잎대리(2): 뇸이(), 똘마니(2806)","떡잎주임(1): 공석","행동대원(5): 김쿵짝(2573), 마이너(393), 한지우(2547), 참마(2548), 함찌(3796)","수습원(2): 한이(2700), 김똥땅(1838)","총 인원: 22/25"]},
        tteokleaf:{name:"떡잎방범대",tagline:"“떡잎에서 시작해 방탄처럼 지켜낸다.”",info:"지역 커뮤니티 기반 정보·거래 허브를 지향합니다.",
          products:[{name:"전투 방탄복", price:"2,000,000원", note:"일일 제한: 최소 10개 ~ 무제한"},{name:"확장 탄창", price:"1,500,000원", note:"일일 제한: 최소 10개 ~ 무제한"},{name:"소음기", price:"1,000,000원", note:"일일 제한: 최소 10개 ~ 무제한"}],
          org:["<strong>떡잎방범대 직급표</strong>","","[고위직]","회장(1): 신짱(251)","부회장(1): 빅토르(525)","사장(1): 민돌(545)","부사장(1): 찰리리차드(556)","",
            "[간부직]","전무(2): 마틴(553), 김남정(703)","상무(2): 악마(1025), 길태미(597)","이사(1): 나몽이흙먹지마(958)","",
            "[특수직]","비서(2): 신짱구(1094), 나몽(957)","비서실장(1): 민중(2388)","해외출장파견(1): 투반(459)","",
            "[일반직]","부장(0): 공석","차장(0): 공석","과장(0): 공석","떡잎대리(2): 뇸이(), 똘마니(2806)","떡잎주임(1): 공석","행동대원(5): 김쿵짝(2573), 마이너(393), 한지우(2547), 참마(2548), 함찌(3796)","수습원(2): 한이(2700), 김똥땅(1838)","총 인원: 22/25"]},
        inback:{name:"InBack",tagline:"“이 스테이크가 식기 전에 돌아올게.”",info:"데이터 분석과 자동화를 통해 의사결정을 지원합니다.",
          products:[{name:"와인",price:"1,000,000원",note:"목마름 20% 회복"},{name:"치킨 스테이크",price:"1,000,000원",note:"배고픔 30% 회복"},{name:"척아이롤 스테이크",price:"1,500,000원",note:"배고픔 70% 회복"},{name:"강아지 연어사료",price:"1,500,000원",note:"배고픔 50% 회복"},{name:"캣 연어통조림",price:"1,500,000원",note:"배고픔 50% 회복"},{name:"강아지 오리비스킷",price:"800,000원",note:"배고픔 30% 회복"}],
          org:["<strong>inback 직급표</strong>","","[고위직]","사장: 김민삼(2530)","부사장: 유헴(2216)","매니저: 충서(216), 대꾸(234)","","[간부직]","시니어키: 얌표(224), 핑크(244), 하늘(298), 뚜기(1038), 코인(2122)","슈퍼바이저: 몽쉘(738), 짭구(1586), 루이(3120)","","[일반직]","웨이터(4): 코넛(502), 강준혁(3376), 정케천(3395), 레모나(3625)","호스트(1): 도로로(947)","인턴(4): 투반(459), 페네사(3326), 인직(3626), 김두지(3682)","","[기타]","고라니(202)","총 인원: 22명"]},
        chakani:{name:"차카니",tagline:"“차카니 건들면 안착하다!!”",info:"신뢰 기반의 중고·한정판 거래 플랫폼.",
          products:[{name:"딸기바나나 스무디",price:"2,000,000원"},{name:"아이스 아메리카노",price:"1,000,000원"},{name:"전남친 토스트",price:"1,000,000원"},{name:"펫 미네랄워터",price:"2,000,000원",note:"목마름 50%"},{name:"펫워터",price:"1,000,000원",note:"목마름 30%"},{name:"고양이 츄르",price:"1,000,000원",note:"배고픔 30%"}],
          org:["<strong>차카니 직급표</strong>","","[고위직]","뽀스: 서화(3434)","뿌뽀스: 텐시(2600)","미니뽀스: 장덕촌(2132)","","[간부직]","삐서: 아가(662)","쓰앵님: 유실(1143)","씩씩이: 하루(236)","특별이: —","","[인사팀]","반짝이: —","","[특수직]","금쪽이: 김봉남(291)","","[일반직]","친절이: 알렉산드론비치(1675)","성실이: 무거미(2277)","바른이: 하냥이(269), 고옹자(2128)","어린이: 미니(2774), 뽕미선(3844), 영월(3219), 신형만(3833)","총 인원: 15명"]}
      },
      civil:{
        ems:{name:"EMS",tagline:"“우리의 출동 하나가, 서버 분위기를 바꾼다.”",info:"응급의료와 재난 골든타임을 책임집니다.",
          products:[{name:"진통제",price:"1,000,000원",note:"하루 최대 100개 구매 가능"},{name:"애완동물 치료제",price:"3,000,000원",note:"하루 최대 10개 구매 가능 (임시)"}],
          org:["<strong>EMS 직급표</strong>","의료국장(1/1): 박지(105)","","[고위직]","병원장(0/1): —","부원장(2/2): 보름달(616), 하즈루(129)","센터장(2/3): 재훈(541), 박칠순(386)","","[간부직]","본부장(0/4): —","구급과장(0/4): —","구급대장(3/4): 옥슈슈(2763), 쵸파(1982), 승주(2036)","","[일반직]","구급팀장(1/6): 리윤(263)","선임 구급대원(1/10): 채언(395)","구급대원(6/∞): 이온(392), 똥냥꿍(2522), 토요일(2685), 마공포(258), 땅코(2099), 이프(3516)","구급대원 인턴(5/∞): 장광남(2504), 위도(3104), 브기(619), 홍예린(342), 이숙희(3458)","","[대기발령]","부라보콘(177) — 병원장 / 엔젤(199) — 센터장 / 갓상현(1164) — 구급팀장 / 새월이(117), 이우연(865) — 구급대원","","[인사과]","인사과장: 부라보콘(616)","인사대원: 하즈루(129), 쵸파(1982), 승주(2036)","","[감찰과]","감찰과장: 보름달(616)","감찰대원: 박칠순(386), 군반(2058), 옥슈슈(2763)","총 인원: 27명"]},
        southpd:{name:"남부경찰",tagline:"“시민을 위한 가장 가까운 힘”",info:"",products:[],
          org:["<strong>남부경찰 직급표</strong>","[고위직]","치안총감: 뭉콩(301)","치안정감: 이만득(257)","치안감: 스왓(120)","경무관: 윈스턴(687)","","[간부직]","행정관(명예직급): 칸콩(150)","총경: 백마(212)","경정: 이글(672), 김선우(1603)","경감 3호봉: 듀니(601)","경감 2호봉: —","경감 1호봉: 황창수(225), 송송(387), 정훈(624)","","[일반직]","경위 3호봉: 바엘(273)","경위 2호봉: —","경위 1호봉: 하하(420)","경사 3호봉: 키티(1540)","경사 2호봉: 매월(1212)","경사 1호봉: 고영희(104), 세이(268), 윤윤(1766)","경장 3호봉: 헬사(431)","경장 2호봉: 신태양(2562)","경장 1호봉: 치나츠(2629)","순경 3호봉: 황병장(2541), 박카수(2714)","순경 2호봉: 하나둘셋(3636)","순경 1호봉: 시나(2040), 공공팔(2778), 공공칠(2779), 백강혁(3215), 탄두리마스터(3890), 탄두리치킨(3891)","훈련생: 뿡뿡이(157), 이상현(260), 배팔식(266), 카로(767), 대한(784), 윈스텅(1780), 썸머(3476), 마키(3978)","청소부: 아싸(1544), 으뇽(3202)","","[조직도]","경찰특공대(ESU): 대장 이만득 / 부대장 듀니 / 대원: 백마, 황창수, 송송, 정훈, 탄두리마스터","행정팀: 팀장 윈스턴 / 부팀장 김선우 / 팀원: 스왓, 이글, 바엘, 고영희, 하하, 키티, 공공팔","총 인원: 41명"]},
        northpd:{name:"북부경찰",tagline:"“도망쳐봐야 소용없다~ 북부경찰 출동이다!” 🚓✨",info:"",products:[],
          org:["<strong>북부경찰 직급표</strong>","[고위직]","경찰청장: 김동행(261)","경찰차장: 마필재(1021), 이재성(152)","치안감: 원두(1228), 랜스(712)","경무관: —","총경: —","","[간부직]","경정 3호봉: —","경정 2호봉: —","경정 1호봉: 가마니(656), 호마위(2690)","경감 3호봉: 김류찌(340)","경감 2호봉: —","경감 1호봉: 다니(2456), 임성완(2499), 고영태(985), 민쵸(580)","","[일반직]","순경 3호봉: 김승현(1471), 고로케를왜고로케먹어(2035)","순경 2호봉: 김완숙(1170), 짜쿠(965), 우끼(1700), 춘호(1121), 봉춘(1312), 설여우(2719)","순경 1호봉: 곽창식(2660), 유영경(1278), 보보(2991), 함싸울래(3342), 투팍(2373), 박춘봉(2636), 영띠(3686), 시드(2760), 용용이(772), 충주(1205), 씽냥(115), 낭낭이(1332), 노인간박광우(2794), 모코코(769)","","[교육/기타]","교육생: 뭉이(1047), 만월(562), 춘자(2144)","총 인원: 37명"]},
        castillo:{name:"카스틸로",tagline:"“엔진은 멎어도 카스틸로는 멎지 않는다.”",info:"",products:[
            {name:"방문 수리", price:"3,000,000원"},{name:"출장 수리", price:"5,000,000원"},{name:"북부 출장 수리", price:"6,000,000원"},{name:"극락도 출장 수리", price:"6,000,000원"},{name:"긴급 수리 키트", price:"7,000,000원", note:"하루 최대 5개"}],
          org:["<strong>카스틸로 직급표</strong>","","[임원]","대표이사(1/1): 베베(281)","전무이사(1/1): 사하(201)","본부장(2/2): 장경철(339), 이현(245)","비서팀장(1/1): 강하진(447)","","[기술/운영]","명장(1/1): 곽한구(107)","정비팀장(0/1): —","정비사(7): 피스마이너스원(293), 뿌칙(299), 또미(516), 김연차(627), 모코코(769), 독주(2559), 용궁(719)","인턴(8): 이춘배(3379), 반반(3495), 새벽(1084), 벌레(3868), 양정팔(3588), 이덕팔(3794), 박정호(3658), 권건(3824)","총 인원: 21명"]},
        broadcast:{name:"방송국",tagline:"“시작은 미약해도 끝은 민중이다.”",info:"",products:[],org:["<strong>방송국 직급표</strong>","","[조직]","보도국 / 편성국 / 제작국 / 기술국","[간부]","보도국장, 편성국장, 제작국장, 기술국장"]}
      },
      org:{
        bigdick:{name:"빅딕",tagline:"“크기는 우연이지만, 위대함은 선택이다.”",info:"",products:[
            {name:"권총", price:"20,000,000원"},{name:"SMG", price:"40,000,000원"},{name:"어썰트 라이플", price:"40,000,000원"},{name:"탄약 (500발)", price:"3,000,000원"},
            {name:"야구빠따/손도끼", price:"10,000,000원"},{name:"김장 (일반 시민)", price:"700,000,000원"},{name:"김장 (공무원·팩션)", price:"1,500,000,000원"}],
          org:["<strong>빅딕 직급표</strong>","","[수뇌부]","두목: 김편집(179)","부두목: 우기지마우기(1763), 정우(270)","빅브라더: 도광철(2542), 나기(174)","비서: 츄츄(1593)","","[특별직]","빅딕공주(1): 라희(3667)","","[간부직]","총사령관(0): 공석","부사령관(0): 공석","도살자(0): 공석","무기총책(2): 가영(3088), 킬러조(3096)","마약총책(1): 황춘식(3066)","","[일반직]","척살대장(2): 박정식(1701), 굿땡(134)","척살대원(0): 공석","행동대장(1): 윤미자(3382)","행동대원(2): 사랑이(782), 넨내(3150)","조직원(3): 재웅(3139), 종근(272), 김묵직(3493)","수습원(6): 엽이(3358), 강대근(3933), 하우(3976), 윤끼르까끼르르(3980), 강산(3465), 벙어리(2973)","","[팀 편제]","총관리팀: 김편집(179), 정우(270) | 감사팀: 우기지마우기(1763) | 인사팀: 츄츄(1593), 도광철(2542) | RP지도관리팀: 나기(174)","총 인원: 24/25"]},
        cheongryong:{name:"청룡",tagline:"“천상천하 유아독존, 청룡이 하늘로 서겠다.”",info:"",products:[
            {name:"SMG", price:"40,000,000원"},{name:"AK 소총", price:"40,000,000원"},{name:"권총", price:"20,000,000원"},{name:"총알 (500발)", price:"3,000,000원"},{name:"근접무기", price:"10,000,000원"}],
          org:["<strong>청룡그룹 직급표</strong>","","[고위직]","회장: 구실수(254)","부회장: 김실망(377), 김편짚(252)","실장: 설이(137)","비서실장: 연매화(486)","","[간부직]","참모장: 우식(564)","비서: 하린(230)","고문장: 브라이언근철(1757)","관리대장: —","행동대장: 태무(614), 오대수(771)","","[일반직]","행동팀장: 강태공(233)","행동원: 토마토우(143), 박가람, 멩멩(3221)","조직원: 조광철(2782), 태윤(3709)","수습일원: 효끼르까끼르(3983), 궤민(3979)","","[팀 편제](참고)","총관리팀: 구실수 | 부총관리팀: 김편짚 | 인사 팀장: 설이 | 인사 팀원: 김실망","총 인원: 19명"]},
        sakura:{name:"사쿠라",tagline:"“벚꽃은 만개할 때 화려한 법이다.”",info:"",products:[
            {name:"조선백자", price:"10,000,000원"},{name:"분청사기", price:"10,000,000원"},{name:"고려청자", price:"10,000,000원"},{name:"기타 장물", price:"4,000,000원", note:"참치 오도로 / 벨루가 캐비어 / 푸아그라 / 산삼"},
            {name:"금 귀걸이", price:"72,000,000원"},{name:"명품 시계", price:"72,000,000원"},{name:"다이아몬드 반지", price:"64,000,000원"},{name:"금괴", price:"64,000,000원"},{name:"블랙머니 수수료", price:"30%", note:"구매가의 30%"}],
          org:["<strong>사쿠라 직급표</strong>","","[고위직]","오야붕: 애기(708)","부오야붕: 르시(907)","행동대장: 릴딕(907)","","[간부직]","만개: —","볒바람: —","낙화: 핑퐁(714)","","[일반직]","꽃받침: —","꽃줄기: —","꽃잎: 훈재(939), 흑백(1426)","꽃봉오리: 현우(2634), 스컬(2724), 서하늘(2739), 파링(2490), 딸통(3218), 노칠(652)","꽃눈: 피로(1987), 푸른하늘(581)","","[특별직]","천본앵: 히힛(768)","장로: 아키라(248), 데키(571)","화검대: —","총원: 17 / 25"]},
        jakdu:{name:"작두",tagline:"“와신상담(臥薪嘗膽)”",info:"",products:[
            {name:"어썰트 라이플", price:"40,000,000원"},{name:"SMG", price:"40,000,000원"},{name:"권총", price:"20,000,000원"},{name:"탄약 (500발)", price:"3,000,000원"},{name:"식칼/손도끼", price:"10,000,000원"}],
          org:["<strong>작두 직급표</strong>","","[고위직]","회장(삼팔광땡): 조근식(1275)","부회장(일팔광땡): 박형식(660)","일삼광땡: 너구리(219)","암행어사 참모: 러버덕(796), 덕출(227)","[간부직]","알리: 정부장(891)","독사: 이쨔(1839)","구삥: 대머리신사(2728)","장삥: 조쿠와라(1810)","","","","[특수직]","예림이: 박말순(654)","[일반직]","갑오: 공석 ","한끗: 홍금쪽(3845), 주야(3432)","끗: 르마(2544), 송실수(2553), 고도리(3161), 미스터갱(130), 유월(3462)","","[수습원]","망통: 베배(1712), 짱돌(3566), 귤탱이(3652), 두꺼비(3461), 반하준(1160), 키위믹스(3889), 최동웅(3934)","총 인원: 25/25"]}
      }
    };

    /* ---------- 네비/서브페이지 ---------- */
    function showPage(pageId){
      document.querySelectorAll('.page').forEach(s=>s.classList.remove('active'));
      const el=document.getElementById(pageId);
      if(el){ el.classList.add('active'); window.scrollTo({top:0,behavior:'smooth'}); }
      toggleBroadcastBox();
    }
    function goHome(){ showPage('home'); }
    function showSubPage(id){
      document.querySelectorAll('#home .sub-page').forEach(div=>div.classList.remove('active'));
      document.getElementById(id).classList.add('active');
    }

    /* 홈에서만 리얼 방송국 표시 */
    function toggleBroadcastBox(){
      const isHome = document.getElementById('home')?.classList.contains('active');
      const bx = document.getElementById('broadcastBox');
      if(bx) bx.style.display = isHome ? '' : 'none';
    }

    /* ---------- 카테고리 퀵 이동 ---------- */
    function scrollToSection(id){
      const el=document.getElementById(id);
      if(el) el.scrollIntoView({behavior:"smooth",block:"start"});
    }

    /* ---------- 거래 통계/인기 TOP5 ---------- */
    const items=[
      {name:"펫 입양권",volume:0,price:200,change:0},
      {name:"트월킹",volume:0,price:30,change:0},
    ];
    function renderTable(){
      const tbody=document.querySelector("#itemTable tbody");
      if(!tbody) return;
      tbody.innerHTML="";
      items.forEach(it=>{
        const cls=it.change>0?"up":it.change<0?"down":"";
        tbody.innerHTML+=`
          <tr>
            <td>${it.name}</td>
            <td>${it.volume}</td>
            <td>${it.price}억</td>
            <td class="${cls}">${it.change>0?"▲":it.change<0?"▼":"-"} ${it.change}%</td>
          </tr>`;
      });
    }
    function renderTop(){
      const ul=document.querySelector("#topList");
      if(!ul) return;
      ul.innerHTML=items.slice().sort((a,b)=>b.volume-a.volume).slice(0,5)
        .map(it=>`<li>${it.name} (${it.volume}건)</li>`).join("");
    }

    /* ---------- 조직도 포맷터 ---------- */
    function formatOrg(lines){
      return lines.map(raw=>{
        const t=(raw??"").trim();
        if(!t) return `<li class="org-gap"></li>`;
        if(/^<strong/i.test(t)) return `<li class="org-title">${t}</li>`;
        if(/^\[.*\]$/.test(t)) {
          const label=t.replace(/^\[|\]$/g,"");
          return `<li class="org-section"><span>${label}</span></li>`;
        }
        if(t.includes("총 인원") || t.includes("총원")) {
          return `<li class="org-total">${t}</li>`;
        }
        return `<li class="org-item"><span class="dot"></span>${t}</li>`;
      }).join("");
    }

    /* ---------- 엔티티 모달 ---------- */
    const KEY_TO_BG = {
      beehive:'bg-beehive', tteokleaf:'bg-tteok-green',
      inback:'bg-inback', chakani:'bg-chakani',
      ems:'bg-ems', southpd:'bg-southpd', northpd:'bg-northpd', castillo:'bg-castillo', broadcast:'bg-broadcast',
      bigdick:'bg-bigdick', cheongryong:'bg-cheongryong', sakura:'bg-sakura', jakdu:'bg-jakdu',
    };

    function openEntity(type,key){
      const group=ENTITIES[type]||{};
      const ent=group[key];
      if(!ent) return;

      const modal=document.getElementById("modal");
      const content=document.getElementById("modalContent");

      content.className = "modal-content " + (KEY_TO_BG[key] || "");

      document.getElementById("modalTitle").textContent=ent.name;
      document.getElementById("modalTagline").textContent = ent.tagline || "—";

      document.querySelectorAll('.modal-tab').forEach(t=>t.classList.remove('active'));
      document.getElementById("modal-org").classList.add('active');

      const orgUL=document.getElementById("modalOrgList");
      orgUL.innerHTML = (ent.org && ent.org.length)
        ? formatOrg(ent.org)
        : "<li class='org-item'><span class='dot'></span>등록된 조직도 정보가 없습니다.</li>";

      const prodUL = document.getElementById("modalProdList");
      const hasProducts = Array.isArray(ent.products) && ent.products.length > 0;
      if (hasProducts) {
        prodUL.innerHTML = ent.products.map((p, i) => {
          const delay = i * 40;
          const note = p.note ? `<div class="prod-note">${p.note}</div>` : "";
          return `
            <li class="prod-card" style="animation-delay:${delay}ms">
              <div class="prod-title">${p.name}</div>
              <div class="prod-price">${p.price}</div>
              ${note}
            </li>
          `;
        }).join("");
      } else {
        prodUL.innerHTML = "";
      }

      const info=document.getElementById("modalInfoText");
      info.innerHTML=`<b>한 마디:</b> ${ent.tagline||"—"}<br>${ent.info||""}`;

      const btnProducts = document.querySelector('.modal-nav button[data-tab="products"]');
      btnProducts.style.display = hasProducts ? '' : 'none';

      modal.classList.add('show');
      document.body.style.overflow = 'hidden';
      document.getElementById("modal").setAttribute('aria-hidden','false');
    }
    function closeModal(){
      document.getElementById("modal").classList.remove('show');
      document.body.style.overflow = '';
      document.getElementById("modal").setAttribute('aria-hidden','true');
    }
    function showModalTab(id){
      document.querySelectorAll('.modal-tab').forEach(t=>t.classList.remove('active'));
      document.getElementById("modal-"+id).classList.add('active');
    }

    /* ---------- 도움말(보기 전용) ---------- */
    const HELP_TEXTS = {
      market: `
        <ul>
          <li><b>당근마켓</b>은 개인 간 아이템 거래를 위한 커뮤니티 장터입니다.</li>
          <li>당근마켓 이용 시 <b>기재비용 1억</b>입니다. 이 점 유의하시길 바랍니다.</li>
          <li>기재를 위해 <b>703 김남정 디스코드 DM</b>을 해주시길 바랍니다.</li>
          <li><b>닉네임</b>, <b>고번</b>, <b>품목</b>, <b>가격</b>을 명확히 기재해 주세요.</li>
          <li>안전 거래 팁: 거래 전·후 <b>스크린샷</b>을 남기고, <b>조건/수수료</b>를 사전에 합의하세요.</li>
          <li>운영진은 거래에 직접 개입하지 않으며, 당근마켓은 <b>중매 역할</b>입니다.</li>
          <li>신고/문의는 좌측 <b>공지사항</b>을 참고해 주세요.</li>
        </ul>`
    };
    function openHelp(key){
      const modal = document.getElementById('helpModal');
      const title = document.getElementById('helpTitle');
      const tagline = document.getElementById('helpTagline');
      const content = document.getElementById('helpContent');

      if(key==='market'){
        title.textContent = '당근마켓 도움말';
        tagline.textContent = '커뮤니티 장터 이용 안내';
      } else {
        title.textContent = '도움말';
        tagline.textContent = '안내';
      }
      content.innerHTML = HELP_TEXTS[key] || '<p class="help-view">안내가 없습니다.</p>';

      modal.classList.add('show');
      modal.setAttribute('aria-hidden','false');
      document.body.style.overflow='hidden';
    }
    function closeHelp(){
      const modal = document.getElementById('helpModal');
      modal.classList.remove('show');
      modal.setAttribute('aria-hidden','true');
      document.body.style.overflow='';
    }

    /* ---------- 사연 상세 모달 ---------- */
    const storyMap = new Map();
    function openStory(id){
      const s = storyMap.get(id);
      if(!s) return;
      document.getElementById('sModalTitle').textContent = s.title || '(제목 없음)';
      const nameStr = s.isAnon ? '익명' : (s.nick || '—');
      const codeStr = (!s.isAnon && s.code) ? ` (${s.code})` : '';
      document.getElementById('sModalMeta').textContent = `${nameStr}${codeStr} · ${s._time || ''}`;
      document.getElementById('sModalBody').textContent = s.body || '';
      const cat = document.getElementById('sModalCat');
      cat.textContent = s.category || '기타';
      const song = document.getElementById('sModalSong');
      if(s.song){ song.style.display='inline-flex'; song.textContent = `🎵 ${s.song}`; } else { song.style.display='none'; }
      const m = document.getElementById('storyModal');
      m.classList.add('show');
      m.setAttribute('aria-hidden','false');
      document.body.style.overflow='hidden';
    }
    function closeStory(){
      const m = document.getElementById('storyModal');
      m.classList.remove('show');
      m.setAttribute('aria-hidden','true');
      document.body.style.overflow='';
    }

    /* 초기 렌더 */
    renderTable(); renderTop();

    /* 스크롤 진행바 */
    function onScrollProgress(){
      const h = document.documentElement;
      const scrolled = (h.scrollTop) / (h.scrollHeight - h.clientHeight || 1);
      const bar = document.getElementById('scrollProgress');
      if(bar) bar.style.width = (Math.max(0, Math.min(1, scrolled)) * 100) + '%';
    }
    window.addEventListener('scroll', onScrollProgress, { passive:true });

    document.addEventListener('DOMContentLoaded', ()=>{
      toggleBroadcastBox();
      onScrollProgress();
    });

    /* ===== ✅ 추가: 차량 카드 클릭 → 차량 모달 열기 ===== */
    const CAR_DATA = {
      '테저랙트': { price:'300억', desc:'최고속도 400km/h, 전자식 서스펜션, 탄소섬유 모노코크 섀시.' },
      '네로': { price:'250억', desc:'밸런스가 좋은 전천후 슈퍼카. 일상·레이스 모두 OK.' },
      'M1': { price:'200억', desc:'스포티한 클래식 모델. 커스텀 파츠 호환성 우수.' },
      '쇼타로': { price:'100억', desc:'바이크계의 아이콘. 가속·핸들링 특화.' }
    };

    function openCarModal(){
      const modal = document.getElementById('carModal');
      modal.classList.add('show');
      modal.setAttribute('aria-hidden','false');
      document.body.style.overflow='hidden';
    }
    function closeCarModal(){
      const modal = document.getElementById('carModal');
      modal.classList.remove('show');
      modal.setAttribute('aria-hidden','true');
      document.body.style.overflow='';
    }

    document.addEventListener('click', (e)=>{
      const card = e.target.closest('.car-card');
      if(!card) return;
      const name = card.dataset.car;
      const data = CAR_DATA[name] || {};
      document.getElementById('carModalTitle').textContent = name || '차량';
      document.getElementById('carModalPrice').textContent = '가격: ' + (data.price || '-');
      document.getElementById('carModalDesc').textContent = data.desc || '세부 정보가 없습니다.';
      openCarModal();
    });
  </script>

  <!-- ===== Firebase + Firestore (사연 신청 + 목록) ===== -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-analytics.js";
    import { getFirestore, collection, addDoc, serverTimestamp, query, orderBy, limit, onSnapshot } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-firestore.js";
    import { getAuth, signInAnonymously } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-auth.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBQt_sPa5B4rHWAHTn9piQ6mYYmTDpxykM",
      authDomain: "information-5461a.firebaseapp.com",
      projectId: "information-5461a",
      storageBucket: "information-5461a.firebasestorage.app",
      messagingSenderId: "1051085585657",
      appId: "1:1051085585657:web:c9b43d1b000aa30a233628",
      measurementId: "G-2VD58S8V9C"
    };

    const app = initializeApp(firebaseConfig);
    try { getAnalytics(app); } catch(e){}
    const db = getFirestore(app);
    const auth = getAuth(app);

    signInAnonymously(auth).catch(console.error);

    const storiesRef = collection(db, "stories");

    /* ---- 폼 엘리먼트 ---- */
    const storyForm = document.getElementById("storyForm");
    const storyNick = document.getElementById("storyNick");
    const storyCode = document.getElementById("storyCode");
    const storyTitle = document.getElementById("storyTitle");
    const storyBody = document.getElementById("storyBody");
    const storyMsg  = document.getElementById("storyMsg");
    const storySong = document.getElementById("storySong");
    const storyCategory = document.getElementById("storyCategory");
    const anonSwitch = document.getElementById("anonSwitch");
    const storyList = document.getElementById("storyList");
    const storyFilter = document.getElementById("storyFilter");

    /* ---- 익명 스위치 ---- */
    function setAnon(active){
      anonSwitch.classList.toggle('active', !!active);
      anonSwitch.setAttribute('aria-checked', active ? 'true' : 'false');
      updateAnonUI();
    }
    function updateAnonUI(){
      const anon = anonSwitch.classList.contains('active');
      [storyNick, storyCode].forEach((el)=>{
        el.disabled = anon;
        if(anon) el.value = '';
        if(el === storyNick) el.placeholder = anon ? '익명 모드' : '닉네임';
        if(el === storyCode) el.placeholder = anon ? '익명 모드' : '고번 (예: 251)';
      });
    }
    setAnon(false);
    updateAnonUI();
    anonSwitch.addEventListener('click', ()=> setAnon(!anonSwitch.classList.contains('active')));
    anonSwitch.addEventListener('keydown', (e)=>{ if(e.key===' '||e.key==='Enter'){ e.preventDefault(); setAnon(!anonSwitch.classList.contains('active')); }});

    /* ---- 제출 ---- */
    storyForm?.addEventListener("submit", async (e)=>{
      e.preventDefault();
      const isAnon = anonSwitch.classList.contains('active');
      // ✅ 익명이면 닉/고번 저장하지 않음
      const nick  = isAnon ? "" : (storyNick.value||"").trim();
      const code  = isAnon ? "" : (storyCode.value||"").trim();
      const title = (storyTitle.value||"").trim();
      const body  = (storyBody.value||"").trim();
      const song  = (storySong.value||"").trim();
      const category = storyCategory.value || "";

      if(!title || !body || !category){
        storyMsg.textContent = "카테고리/제목/내용은 필수입니다.";
        storyMsg.style.color = "#dc2626";
        return;
      }
      if(!isAnon && !nick && !code){
        storyMsg.textContent = "익명이 아니면 닉네임 또는 고번을 입력하세요.";
        storyMsg.style.color = "#dc2626";
        return;
      }

      storyForm.querySelector("button[type=submit]").disabled = true;
      storyMsg.textContent = "전송 중...";
      storyMsg.style.color = "#6b7280";
      try{
        await addDoc(storiesRef, { isAnon, nick, code, title, body, song, category, createdAt: serverTimestamp() });
        storyMsg.textContent = "사연이 접수되었습니다! 감사합니다.";
        storyMsg.style.color = "#16a34a";
        storyTitle.value = "";
        storyBody.value = "";
        storySong.value = "";
        // 카테고리/익명 설정은 유지
      }catch(err){
        storyMsg.textContent = "사연 전송 실패: " + (err?.message||err);
        storyMsg.style.color = "#dc2626";
      }finally{
        storyForm.querySelector("button[type=submit]").disabled = false;
      }
    });

    /* ---- 최신 사연 구독 + 렌더러 ---- */
    function fmtTime(ts){
      try{
        const d = ts?.toDate ? ts.toDate() : (ts instanceof Date ? ts : new Date());
        const y = d.getFullYear(), m = ('0'+(d.getMonth()+1)).slice(-2), da=('0'+d.getDate()).slice(-2);
        const hh=('0'+d.getHours()).slice(-2), mm=('0'+d.getMinutes()).slice(-2);
        return `${y}.${m}.${da} ${hh}:${mm}`;
      }catch{ return ""; }
    }

    function renderStoryList(){
      const filterCat = storyFilter?.value || "";
      const all = Array.from(storyMap.values());
      const arr = all.filter(s=> !filterCat || s.category === filterCat);

      if(arr.length===0){
        storyList.innerHTML = `<li class="story-empty">아직 등록된 사연이 없습니다.</li>`;
        return;
      }
      storyList.innerHTML = arr.map(s=>{
        const who  = s.isAnon ? '익명' : (s.nick || '—');
        const code = (!s.isAnon && s.code) ? ` (${s.code})` : '';
        const song = s.song ? ` · 🎵 ${s.song}` : '';
        return `
          <li class="story-item" data-id="${s.id}">
            <div class="left">
              <span class="badge">${s.category||'기타'}</span>
              <div style="display:flex;flex-direction:column;min-width:0">
                <div class="title">${s.title||'(제목 없음)'}</div>
                <div class="meta">${who}${code} · ${s._time || ''}${song}</div>
              </div>
            </div>
            <div class="meta">보기 ▸</div>
          </li>
        `;
      }).join('');

      storyList.querySelectorAll('.story-item').forEach(li=>{
        li.addEventListener('click', ()=> openStory(li.getAttribute('data-id')));
      });
    }

    const qLatest = query(storiesRef, orderBy('createdAt','desc'), limit(50));
    onSnapshot(qLatest, (snap)=>{
      storyMap.clear();
      snap.forEach(doc=>{
        const s = { id: doc.id, ...doc.data() };
        s._time = s.createdAt ? fmtTime(s.createdAt) : '';
        storyMap.set(s.id, s);
      });
      renderStoryList();
    });

    storyFilter?.addEventListener('change', renderStoryList);
  </script>
</body>
</html>
