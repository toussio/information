<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>떡잎방범대 정보 센터</title>
  <style>
    :root{
      --card:#ffffff; --ink:#0f172a; --muted:#475569; --accent:#22c55e; --border:#e5e7eb;
      --company:#3b82f6; --civil:#16a34a; --org:#8b5cf6; --magazine:#f97316;
      --up:#16a34a; --down:#dc2626; --e:cubic-bezier(.22,.9,.24,1);
    }

    /* ★ 전역 박스사이징 */
    html { box-sizing: border-box; font-size:17px; overflow-y:scroll; }
    *, *::before, *::after { box-sizing: inherit; }

    body{margin:0;font-family:"Noto Sans KR",system-ui,-apple-system,Segoe UI,Roboto,sans-serif;color:var(--ink);background:#f0fdf4;line-height:1.6}

    /* 헤더 */
    header{background:#fff;border-bottom:1px solid var(--border);padding:20px;text-align:center;box-shadow:0 2px 6px rgba(0,0,0,.05)}
    header h1{margin:0;font-size:30px;color:var(--accent);font-weight:900;cursor:pointer;transition:transform .2s var(--e)}
    header h1:hover{transform:scale(1.02)}

    /* 레이아웃 */
    .layout{display:grid;grid-template-columns:300px 1fr 300px;column-gap:40px;row-gap:24px;max-width:1600px;margin:20px auto;padding:0 30px}
    main{display:flex;flex-direction:column;gap:20px}

    /* 좌우 사이드 */
    aside{background:var(--card);border-radius:14px;padding:20px;box-shadow:0 4px 12px rgba(0,0,0,.06);position:sticky;top:20px;height:500px;overflow-y:auto}
    aside h3{margin:0 0 12px;color:var(--accent);font-size:16px;font-weight:700}
    aside ul{margin:0;padding-left:18px}
    aside li{margin-bottom:6px}
    .aside-box{margin-bottom:20px;padding:12px;border-radius:10px;background:#fff}
    .aside-box h3{margin:0 0 10px;font-size:16px;font-weight:700;color:var(--accent)}

    /* 히어로 */
    .hero{text-align:center;padding:40px;border-radius:16px;background:linear-gradient(135deg,#bbf7d0,#ecfdf5);box-shadow:0 6px 16px rgba(0,0,0,.08);margin:20px 0;animation:fadeIn .35s var(--e)}
    .hero h2{margin:0 0 14px;color:var(--accent);font-size:26px;font-weight:800}
    .hero p{font-size:16px;color:#374151}

    /* 상단 네비 카드 */
    .nav-parts{display:flex;justify-content:center;gap:24px;margin:20px auto;flex-wrap:wrap}
    .nav-card{flex:1;min-width:150px;max-width:200px;background:linear-gradient(135deg,#dcfce7,#f0fdf4);padding:22px 16px;text-align:center;border-radius:16px;box-shadow:0 6px 14px rgba(0,0,0,.08);cursor:pointer;transition:transform .25s var(--e), box-shadow .25s var(--e)}
    .nav-card:hover{transform:translateY(-6px);box-shadow:0 10px 24px rgba(0,0,0,.12)}
    .nav-card .icon{font-size:28px;margin-bottom:10px}
    .nav-card h3{margin:0;font-size:18px;color:var(--accent);font-weight:700}

    /* 페이지(홈 등) */
    section.page{display:none;padding:28px;background:var(--card);border-radius:14px;box-shadow:0 4px 12px rgba(0,0,0,.05)}
    section.page.active{display:block;animation:pageIn .28s var(--e)}
    section h2{margin:0 0 16px;color:var(--accent);font-size:21px;font-weight:700}

    /* 홈 하위 탭 */
    .sub-nav{display:flex;gap:12px;margin:20px 0;flex-wrap:wrap}
    .sub-nav button{padding:10px 18px;border:none;border-radius:8px;background:var(--accent);color:#fff;font-size:15px;font-weight:600;cursor:pointer;transition:transform .18s var(--e), filter .18s var(--e)}
    .sub-nav button:hover{filter:brightness(.96); transform:translateY(-2px)}
    .sub-page{display:none;margin-top:16px}
    .sub-page.active{display:block;animation:fadeIn .25s var(--e)}

    /* 홈 카드 */
    .card-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:20px;margin-top:16px}
    .card{background:#fff;border-radius:14px;padding:20px;box-shadow:0 4px 12px rgba(0,0,0,.08);transition:transform .25s var(--e),box-shadow .25s var(--e);cursor:pointer;text-align:center;border:2px solid transparent}
    .card:hover{transform:translateY(-6px);box-shadow:0 10px 24px rgba(0,0,0,.12)}
    .card .icon{font-size:30px;margin-bottom:12px}
    .card h4{margin:0 0 6px;font-size:17px;font-weight:700}
    .card p{margin:0;font-size:14.5px;color:#4b5563}
    .company-card{border-color:var(--company)} .company-card .icon,.company-card h4{color:var(--company)}
    .civil-card{border-color:var(--civil)} .civil-card .icon,.civil-card h4{color:var(--civil)}
    .org-card{border-color:var(--org)} .org-card .icon,.org-card h4{color:var(--org)}
    .magazine-card{border-color:var(--magazine)} .magazine-card .icon,.magazine-card h4{color:var(--magazine)}

    /* 카테고리 표 */
    #category table{width:100%;border-collapse:collapse;margin:16px 0 32px;font-size:16px}
    #category th,#category td{padding:14px 12px;border-bottom:1px solid var(--border);text-align:center}
    #category th{background:#e6f9ef;color:#065f46;font-size:17px}
    #category tr:nth-child(even) td{background:#f9fafb}
    #category tr:hover td{background:#dcfce7}
    #category h3{margin-top:40px;font-size:20px;color:var(--accent);font-weight:800;border-left:6px solid var(--accent);padding-left:10px}
    .quick-nav{display:flex;flex-wrap:wrap;gap:10px;margin:16px 0 24px}
    .quick-nav button{padding:8px 14px;border:none;border-radius:8px;background:var(--accent);color:#fff;font-size:14px;cursor:pointer;transition:transform .18s var(--e), filter .18s var(--e)}
    .quick-nav button:hover{filter:brightness(.96); transform:translateY(-2px)}

    /* ===== 🔽 추가: 차량 판매 시세표 카드 + 애니메이션 ===== */
    .car-sale-grid{
      display:grid;
      grid-template-columns:repeat(auto-fill,minmax(200px,1fr));
      gap:20px;
      margin-top:20px;
    }
    .car-card{
      background:#fff;
      border-radius:16px;
      padding:20px;
      box-shadow:0 6px 16px rgba(0,0,0,.08);
      text-align:center;
      cursor:pointer;
      transition:transform .25s var(--e), box-shadow .25s var(--e);
      border:2px solid transparent;
      animation:fadeInUp .4s ease forwards;
    }
    .car-card:hover{
      transform:translateY(-6px);
      box-shadow:0 10px 24px rgba(0,0,0,.12);
      border-color:var(--accent);
    }
    .car-card .icon{font-size:36px;margin-bottom:8px}
    .car-card h4{margin:0 0 6px;font-size:18px;font-weight:800;color:var(--accent)}
    .car-card .price{
      display:inline-block;
      background:#dcfce7;color:#065f46;font-weight:700;font-size:16px;
      padding:6px 14px;border-radius:50px
    }
    @keyframes fadeIn{from{opacity:0;transform:translateY(4px)} to{opacity:1;transform:none}}
    @keyframes pageIn{from{opacity:0;transform:translateY(8px)} to{opacity:1;transform:none}}
    @keyframes fadeInUp{from{opacity:0;transform:translateY(12px)} to{opacity:1;transform:none}}

  </style>
</head>

  <body>
  <header><h1 onclick="goHome()">떡잎방범대 정보 센터</h1></header>
  <div id="scrollProgress" aria-hidden="true"></div>

  <div class="layout">
    <!-- 왼쪽 -->
    <aside>
      <div class="aside-box">
        <h3>📢 공지사항</h3>
        <ul>
          <li>떡잎방범대 정보 센터 OPEN</li>
          <li>떡잎방범대 투자 센터 리뉴얼</li>
          <li>🙏문의: 703 김남정, 디코 dm</li>
        </ul>
      </div>
      <div class="aside-box">
        <h3>🎉 다가오는 이벤트</h3>
        <ul>
          <li> 🎴 작두 호스트바</li>
          <li> 🍀 떡잎방범대 이벤트</li>
          <li> 💍 정부장, 원두 결혼식</li>
        </ul>
      </div>
    </aside>

    <!-- 중앙 -->
    <main>
      <div class="nav-parts">
        <div class="nav-card" onclick="showPage('home')"><div class="icon">🏠</div><h3>홈</h3></div>
        <div class="nav-card" onclick="showPage('car-market')"><div class="icon">🚗</div><h3>차량 판매표</h3></div>
        <div class="nav-card" onclick="showPage('category')"><div class="icon">📂</div><h3>카테고리</h3></div>
        <div class="nav-card" onclick="showPage('stats')"><div class="icon">📈</div><h3>거래 통계</h3></div>
      </div>

      <div class="hero"><h2>📊 정보 센터</h2><p>리얼월드의 아이템 시세와 조직 정보를 한눈에!</p></div>

      <!-- 홈 -->
      <section id="home" class="page active">
        <h2>🏠 홈</h2>
        <div class="sub-nav">
          <button onclick="showSubPage('company')">기업</button>
          <button onclick="showSubPage('civil')">공무원</button>
          <button onclick="showSubPage('org')">조직</button>
          <button onclick="showSubPage('magazine')">메거진</button>
        </div>

        <!-- 기업 -->
        <div id="company" class="sub-page active">
          <h3>🏢 기업</h3>
          <div class="card-grid">
            <div class="card company-card" onclick="openEntity('company','beehive')">
              <div class="icon">🐝</div><h4>벌집</h4><p>-</p>
            </div>
            <div class="card company-card" onclick="openEntity('company','inback')">
              <div class="icon">🍖</div><h4>InBack</h4><p>-</p>
            </div>
            <div class="card company-card" onclick="openEntity('company','chakani')">
              <div class="icon">🦄</div><h4>차카니</h4><p>-</p>
            </div>
            <div class="card company-card" onclick="openEntity('company','tteokleaf')">
              <div class="icon">🍀</div><h4>떡잎방범대</h4><p>-</p>
            </div>
          </div>
        </div>

        <!-- 공무원 -->
        <div id="civil" class="sub-page">
          <h3>🏛 공무원</h3>
          <div class="card-grid">
            <div class="card civil-card" onclick="openEntity('civil','ems')">
              <div class="icon">🚑</div><h4>EMS</h4><p>-</p>
            </div>
            <div class="card civil-card" onclick="openEntity('civil','southpd')">
              <div class="icon">👮</div><h4>남부경찰</h4><p>-</p>
            </div>
            <div class="card civil-card" onclick="openEntity('civil','northpd')">
              <div class="icon">🚓</div><h4>북부경찰</h4><p>-</p>
            </div>
            <div class="card civil-card" onclick="openEntity('civil','castillo')">
              <div class="icon">🚧</div><h4>카스틸로</h4><p>-</p>
            </div>
            <div class="card civil-card" onclick="openEntity('civil','broadcast')">
              <div class="icon">🌐</div><h4>방송국</h4><p>-</p>
            </div>
          </div>
        </div>

        <!-- 조직 -->
        <div id="org" class="sub-page">
          <h3>👥 조직</h3>
          <div class="card-grid">
            <div class="card org-card" onclick="openEntity('org','bigdick')">
              <div class="icon">🍌</div><h4>빅딕</h4><p>-</p>
            </div>
            <div class="card org-card" onclick="openEntity('org','cheongryong')">
              <div class="icon">💎</div><h4>청룡</h4><p>-</p>
            </div>
            <div class="card org-card" onclick="openEntity('org','sakura')">
              <div class="icon">🌸</div><h4>사쿠라</h4><p>-</p>
            </div>
            <div class="card org-card" onclick="openEntity('org','jakdu')">
              <div class="icon">🎴</div><h4>작두</h4><p>-</p>
            </div>
          </div>
        </div>

        <!-- 메거진 -->
        <div id="magazine" class="sub-page">
          <h3>📰 메거진</h3>
          <div class="card-grid">
            <div class="card magazine-card">
              <div class="icon">🚀</div><h4>미래 기술 트렌드</h4><p>AI, 메타버스, 친환경 산업</p>
            </div>
          </div>
        </div>
      </section>

      <!-- 리얼 방송국 (홈 섹션 바로 아래, 같은 폭) -->
      <div id="broadcastBox">
        <div class="title-row">
          <h2>📡 리얼 방송국</h2>
          <span class="pill">실시간 접수 · 익명 가능</span>
        </div>
        <p class="desc">사연을 보내면 운영진 확인 후 방송으로 소개돼요. <span class="hint">* 로그인 없이 익명 접수 가능</span></p>

        <div class="broadcast-grid">
          <!-- 사연 신청 -->
          <div class="story-card">
            <h3>📝 사연 신청</h3>
            <form id="storyForm" class="story-form" novalidate>
              <div class="row double">
                <label for="storyNick">보내는 분</label>
                <input id="storyNick" type="text" placeholder="닉네임" />
                <input id="storyCode" type="text" placeholder="고번 (예: 251)" />
              </div>

              <div class="row">
                <label for="storyCategory">카테고리</label>
                <select id="storyCategory" required>
                  <option value="" disabled selected>카테고리를 선택하세요</option>
                  <option>연애</option><option>우정</option><option>사건/사고</option><option>일상</option>
                  <option>웃긴 일</option><option>감동</option><option>음악사연</option><option>기타</option>
                </select>
              </div>

              <div class="row">
                <label for="storyTitle">제목</label>
                <input id="storyTitle" type="text" placeholder="사연 제목" maxlength="60" required />
              </div>

              <div class="row">
                <label for="storySong">신청곡</label>
                <input id="storySong" type="text" placeholder="예: 아이유 - 밤편지 (선택)" />
              </div>

              <div class="row" style="align-items:start">
                <label for="storyBody">내용</label>
                <textarea id="storyBody" placeholder="사연 내용을 입력하세요" required></textarea>
              </div>

              <div class="row">
                <label>익명</label>
                <div class="inline">
                  <div id="anonSwitch" class="switch" role="switch" aria-checked="false" tabindex="0"></div>
                  <span class="hint">익명으로 보내기</span>
                </div>
              </div>

              <div class="row actions">
                <button type="submit" class="btn">사연 보내기</button>
              </div>
              <div id="storyMsg" class="hint" style="margin-top:4px" aria-live="polite"></div>
            </form>
          </div>

          <!-- 최신 사연 -->
          <div class="story-list">
            <div class="head">
              <h3>🗂 최신 사연</h3>
              <div class="filters">
                <select id="storyFilter" class="pill">
                  <option value="">전체</option>
                  <option>연애</option><option>우정</option><option>사건/사고</option><option>일상</option>
                  <option>웃긴 일</option><option>감동</option><option>음악사연</option><option>기타</option>
                </select>
              </div>
            </div>
            <ul id="storyList"></ul>
          </div>
        </div>
      </div>
      <!-- /리얼 방송국 -->

      <!-- 차량 판매표 (전용 페이지) -->
      <section id="car-market" class="page">
        <div class="section-header">
          <h2>🚗 차량 판매표</h2>
          <button class="help-pill" onclick="openHelp('market')">차량 판매 안내</button>
        </div>
        <!-- ✅ JS에서 VEHICLE_CATALOG로 각 카테고리 표 자동 생성 -->
        <div id="carTables"></div>
      </section>

      <!-- 카테고리 -->
      <section id="category" class="page">
        <h2>📂 카테고리별 시세표</h2>
        <div class="quick-nav">
          <button onclick="scrollToSection('chair')">🪑 의자 종류</button>
          <button onclick="scrollToSection('support-car')">🚗 후원 차량</button>
          <button onclick="scrollToSection('island-car')">🏝 극락도 차량</button>
          <button onclick="scrollToSection('effect')">✨ 이펙트</button>
          <button onclick="scrollToSection('skin')">🎭 스킨</button>
          <button onclick="scrollToSection('dance')">💃 행동·댄스·동상</button>
          <button onclick="scrollToSection('item')">✨ 기타</button>
          <button onclick="scrollToSection('car-sale')">🚗 차량 판매 시세표</button>
        </div>

        <h3 id="chair">🪑 의자 종류</h3>
        <table>
          <tr><th>아이템</th><th>시세</th></tr>
          <tr><td>달의자</td><td>230억~250억</td></tr>
          <tr><td>커피의자</td><td>230억~250억</td></tr>
          <tr><td>새장의자</td><td>160억~190억</td></tr>
          <tr><td>구름의자</td><td>270억~300억</td></tr>
        </table>

        <h3 id="support-car">🚗 후원 차량</h3>
        <table>
          <tr><th>아이템</th><th>시세</th></tr>
          <tr><td>M1</td><td>170억~200억</td></tr>
          <tr><td>미니바티</td><td>150억~180억</td></tr>
          <tr><td>이그너스</td><td>245억~270억</td></tr>
          <tr><td>M2</td><td>170억~200억</td></tr>
          <tr><td>시노비</td><td>100억~120억</td></tr>
          <tr><td>네로</td><td>230억~250억</td></tr>
          <tr><td>쇼타로</td><td>80억~100억</td></tr>
          <tr><td>M3</td><td>150억~200억</td></tr>
          <tr><td>테저랙트</td><td>270억~300억</td></tr>
          <tr><td>M4</td><td>170억~200억</td></tr>
          <tr><td>하쿠쵸우</td><td>80억~110억</td></tr>
        </table>

        <h3 id="island-car">🏝 극락도 차량</h3>
        <table>
          <tr><th>아이템</th><th>시세</th></tr>
          <tr><td>바나나카</td><td>60억~80억</td></tr>
          <tr><td>고양카</td><td>70억~100억</td></tr>
          <tr><td>피넛카</td><td>70억~100억</td></tr>
        </table>

        <h3 id="effect">✨ 이펙트</h3>
        <table>
          <tr><th>아이템</th><th>시세</th></tr>
          <tr><td>불손</td><td>220억~270억</td></tr>
          <tr><td>불발</td><td>200억~250억</td></tr>
          <tr><td>리프</td><td>140억~180억</td></tr>
          <tr><td>번개</td><td>130억~150억</td></tr>
          <tr><td>꽃잎비</td><td>250억~280억</td></tr>
        </table>

        <h3 id="skin">🎭 스킨</h3>
        <table>
          <tr><th>아이템</th><th>시세</th></tr>
          <tr><td>다니엘</td><td>200억~240억</td></tr>
          <tr><td>HJ</td><td>150억~200억</td></tr>
          <tr><td>YH</td><td>140억~180억</td></tr>
          <tr><td>다혜</td><td>80억~130억</td></tr>
          <tr><td>유자</td><td>80억~130억</td></tr>
          <tr><td>문신남</td><td>????</td></tr>
          <tr><td>병아리</td><td>150억~180억</td></tr>
          <tr><td>고양이</td><td>150억~180억</td></tr>
        </table>

        <h3 id="dance">💃 행동·댄스·동상</h3>
        <table>
          <tr><th>아이템</th><th>시세</th></tr>
          <tr><td>브레이크댄스</td><td>10억~15억</td></tr>
          <tr><td>오징어댄스</td><td>10억~15억</td></tr>
          <tr><td>브로큰레그</td><td>5억~8억</td></tr>
          <tr><td>마그네틱</td><td>30억~45억</td></tr>
          <tr><td>텔미댄스</td><td>30억~40억</td></tr>
          <tr><td>버스안에서댄스</td><td>6억~8억</td></tr>
          <tr><td>스마트댄스</td><td>30억~38억</td></tr>
          <tr><td>소다팝댄스</td><td>38억~46억</td></tr>
          <tr><td>팝핀댄스</td><td>5억~10억</td></tr>
          <tr><td>스캇앤젤다댄스</td><td>20억~28억</td></tr>
          <tr><td>뻣뻣로봇댄스</td><td>6억~10억</td></tr>
          <tr><td>골반흔들기</td><td>15억~20억</td></tr>
          <tr><td>크레이지트워킹</td><td>15억~20억</td></tr>
          <tr><td>슬릭백</td><td>18억~27억</td></tr>
          <tr><td>이리와</td><td>5억~8억</td></tr>
          <tr><td>언더더씨</td><td>5억~8억</td></tr>
          <tr><td>쌍뻐큐</td><td>10억~15억</td></tr>
          <tr><td>맘맘</td><td>7억~11억</td></tr>
          <tr><td>회전회오리</td><td>18억~24억</td></tr>
          <tr><td>쏘리댄스</td><td>5억~10억</td></tr>
          <tr><td>하트 동상포즈(남)</td><td>10억~15억</td></tr>
          <tr><td>하트 동상포즈(여)</td><td>11억~16억</td></tr>
          <tr><td>동상포즈(남)</td><td>10억~15억</td></tr>
          <tr><td>동상포즈(여)</td><td>11억~15억</td></tr>
          <tr><td>무릎앉기</td><td>7억~10억</td></tr>
          <tr><td>조신하게 앉기</td><td>8억~10억</td></tr>
          <tr><td>괴속질주</td><td>10억~13억</td></tr>
          <tr><td>흔들어</td><td>15억~18억</td></tr>
          <tr><td>오예스</td><td>9억~15억</td></tr>
          <tr><td>요가포즈</td><td>13억~16억</td></tr>
          <tr><td>냄새나</td><td>10억~15억</td></tr>
          <tr><td>쓰러지기</td><td>5억~7억</td></tr>
          <tr><td>기도하는</td><td>5억~10억</td></tr>
          <tr><td>내빵뎅이</td><td>5억~8억</td></tr>
        </table>

        <!-- 카테고리 내 “차량 판매 시세표”(요약 카드) — JS가 채움 -->
        <h3 id="car-sale">🚗 차량 판매 시세표</h3>
        <div class="car-sale-grid" id="carSaleCards"></div>
      </section>

      <!-- 거래 통계 -->
      <section id="stats" class="page">
        <h2>📈 거래 통계</h2>
        <table id="itemTable">
          <thead><tr><th>아이템</th><th>거래량</th><th>평균가</th><th>변동</th></tr></thead>
          <tbody></tbody>
        </table>
      </section>
    </main>

    <!-- 오른쪽 -->
    <aside>
      <h3>🔥 인기 TOP 5</h3>
      <ul id="topList"></ul>
      <h3>⏰ 실시간 알림</h3>
      <ul><li>-</li></ul>
    </aside>
  </div>

  <!-- 엔티티 모달 -->
  <div id="modal" class="modal" aria-hidden="true">
    <div id="modalContent" class="modal-content" role="dialog" aria-modal="true">
      <button class="close-btn" onclick="closeModal()">닫기</button>
      <h3 id="modalTitle"></h3>
      <p id="modalTagline" class="modal-tagline"></p>
      <div class="modal-nav">
        <button data-tab="org" onclick="showModalTab('org')">조직도</button>
        <button data-tab="products" onclick="showModalTab('products')">판매물품</button>
        <button data-tab="info" onclick="showModalTab('info')">기업정보</button>
      </div>
      <div id="modal-org" class="modal-tab">
        <ul id="modalOrgList" class="org-list"></ul>
      </div>
      <div id="modal-products" class="modal-tab">
        <ul id="modalProdList"></ul>
      </div>
      <div id="modal-info" class="modal-tab"><p id="modalInfoText"></p></div>
    </div>
  </div>

  <!-- 사연 상세 모달 -->
  <div id="storyModal" class="modal" aria-hidden="true">
    <div class="modal-content bg-broadcast" role="dialog" aria-modal="true">
      <button class="close-btn" onclick="closeStory()">닫기</button>
      <h3 id="sModalTitle">사연 제목</h3>
      <p class="modal-tagline" id="sModalMeta">작성자 · 시간</p>
      <div class="help-body">
        <div class="help-view" id="sModalBody" style="white-space:pre-wrap"></div>
        <div style="margin-top:10px;display:flex;gap:8px;flex-wrap:wrap">
          <span class="badge" id="sModalCat">카테고리</span>
          <span class="badge" id="sModalSong" style="display:none"></span>
        </div>
      </div>
    </div>
  </div>

  <!-- 도움말 모달 -->
  <div id="helpModal" class="modal" aria-hidden="true">
    <div class="modal-content" role="dialog" aria-modal="true">
      <button class="close-btn" onclick="closeHelp()">닫기</button>
      <h3 id="helpTitle">도움말</h3>
      <p class="modal-tagline" id="helpTagline">안내</p>
      <div class="help-body">
        <div id="helpContent" class="help-view"></div>
      </div>
    </div>
  </div>

  <!-- 차량 상세 모달 -->
  <div id="carModal" class="modal" aria-hidden="true">
    <div class="modal-content" role="dialog" aria-modal="true">
      <button class="close-btn" onclick="closeCarModal()">닫기</button>
      <h3 id="carModalTitle">차량명</h3>
      <p id="carModalPrice" class="modal-tagline">가격 정보</p>
      <div id="carModalDesc" style="line-height:1.8">세부 설명이 여기에 표시됩니다.</div>
    </div>
  </div>

    <script>
/* ---------- ENTITIES: 기업·공무원·조직 데이터 ---------- */
const ENTITIES = {
  company: {
    beehive: { name: "벌집", tagline: "“ - ”", info: "지역 커뮤니티 기반 정보·거래 허브를 지향합니다.", products: [], org: [] },
    tteokleaf: { name: "떡잎방범대", tagline: "“떡잎에서 시작해 방탄처럼 지켜낸다.”", info: "지역 커뮤니티 기반 정보·거래 허브를 지향합니다.", products: [], org: [] },
    inback: { name: "InBack", tagline: "“이 스테이크가 식기 전에 돌아올게.”", info: "데이터 분석과 자동화를 통해 의사결정을 지원합니다.", products: [], org: [] },
    chakani: { name: "차카니", tagline: "“차카니 건들면 안착하다!!”", info: "신뢰 기반의 중고·한정판 거래 플랫폼.", products: [], org: [] }
  },
  civil: {
    ems: { name: "EMS", tagline: "“우리의 출동 하나가, 서버 분위기를 바꾼다.”", info: "응급의료와 재난 골든타임을 책임집니다.", products: [], org: [] },
    southpd: { name: "남부경찰", tagline: "“시민을 위한 가장 가까운 힘”", info: "", products: [], org: [] },
    northpd: { name: "북부경찰", tagline: "“도망쳐봐야 소용없다~ 북부경찰 출동이다!” 🚓✨", info: "", products: [], org: [] },
    castillo: { name: "카스틸로", tagline: "“엔진은 멎어도 카스틸로는 멎지 않는다.”", info: "", products: [], org: [] },
    broadcast: { name: "방송국", tagline: "“시작은 미약해도 끝은 민중이다.”", info: "", products: [], org: [] }
  },
  org: {
    bigdick: { name: "빅딕", tagline: "“크기는 우연이지만, 위대함은 선택이다.”", info: "", products: [], org: [] },
    cheongryong: { name: "청룡", tagline: "“천상천하 유아독존, 청룡이 하늘로 서겠다.”", info: "", products: [], org: [] },
    sakura: { name: "사쿠라", tagline: "“벚꽃은 만개할 때 화려한 법이다.”", info: "", products: [], org: [] },
    jakdu: { name: "작두", tagline: "“와신상담(臥薪嘗膽)”", info: "", products: [], org: [] }
  }
};

/* ---------- VEHICLE_CATALOG: 차량 판매 시세표 데이터 ---------- */
const VEHICLE_CATALOG = {
  "오프로드": [
    { name: "디로더", price: "1,500,000,000원", note: "2인승" },
    { name: "에버온", price: "1,500,000,000원", note: "4인승" },
    { name: "요세미터3", price: "1,500,000,000원", note: "2인승" },
    { name: "메사", price: "1,620,000,000원", note: "4인승" },
    { name: "듀브스타", price: "2,540,000,000원", note: "4인승" },
    { name: "프리크롤러", price: "3,670,000,000원", note: "4인승" }
  ],
  "머슬카": [
    { name: "탐파2", price: "2,840,000,000원", note: "2인승" }
  ],
  "밴": [
    { name: "반캣XL", price: "1,500,000,000원", note: "4인" },
    { name: "부리토", price: "1,500,000,000원", note: "6인" },
    { name: "서버", price: "2,620,000,000원", note: "6인" }
  ],
  "스포츠카": [
    { name: "엘리지2", price: "1,520,000,000원" },
    { name: "코그브리오", price: "1,680,000,000원" },
    { name: "재칼", price: "1,740,000,000원" },
    { name: "미쉘리", price: "1,750,000,000원" },
    { name: "버팔로", price: "1,800,000,000원" },
    { name: "버팔로2", price: "1,820,000,000원" },
    { name: "버팔로3", price: "1,840,000,000원" },
    { name: "GB200", price: "1,680,000,000원" },
    { name: "재스터3", price: "1,900,000,000원" },
    { name: "마사크로", price: "1,920,000,000원" },
    { name: "마사크로2", price: "1,940,000,000원" },
    { name: "베스트아GTS", price: "2,520,000,000원" },
    { name: "펠론", price: "2,600,000,000원" },
    { name: "트로포스", price: "2,660,000,000원" },
    { name: "슬라겐", price: "2,880,000,000원" },
    { name: "코멧3", price: "2,900,000,000원" },
    { name: "백트레", price: "2,920,000,000원" },
    { name: "드래프터", price: "2,940,000,000원" },
    { name: "주글러", price: "2,960,000,000원" },
    { name: "팡테르", price: "3,700,000,000원" },
    { name: "펠른2", price: "3,730,000,000원" },
    { name: "파리아", price: "3,790,000,000원" },
    { name: "네온", price: "3,970,000,000원" }
  ],
  "클래식": [
    { name: "토르네이도", price: "1,560,000,000원" },
    { name: "토나도5", price: "1,580,000,000원" },
    { name: "토네이도6", price: "1,600,000,000원" },
    { name: "디이너스티", price: "1,760,000,000원" },
    { name: "Z190", price: "1,880,000,000원" },
    { name: "GT500", price: "1,960,000,000원" },
    { name: "코켓2", price: "1,980,000,000원" },
    { name: "코켓5", price: "2,000,000,000원" },
    { name: "인퍼너스2", price: "2,580,000,000원" }
  ],
  "세단": [
    { name: "콕55", price: "1,540,000,000원" },
    { name: "스태포드", price: "1,700,000,000원" },
    { name: "라인하트", price: "2,800,000,000원" },
    { name: "친퀘밀라", price: "3,910,000,000원" }
  ],
  "슈퍼카": [
    { name: "페네트레이터", price: "2,680,000,000원" },
    { name: "GP1", price: "2,980,000,000원" },
    { name: "치타2", price: "3,000,000,000원" },
    { name: "몰릭", price: "3,820,000,000원" },
    { name: "바카", price: "3,850,000,000원" },
    { name: "인퍼너스", price: "3,940,000,000원" },
    { name: "반시2", price: "4,000,000,000원" }
  ],
  "SUV": [
    { name: "그레슬리", price: "1,640,000,000원" },
    { name: "FQ2", price: "1,660,000,000원" },
    { name: "힌틀리", price: "1,720,000,000원" },
    { name: "더브스타2", price: "2,560,000,000원" },
    { name: "이시8", price: "2,700,000,000원" },
    { name: "발러3", price: "2,720,000,000원" },
    { name: "발러4", price: "2,740,000,000원" },
    { name: "발러7", price: "2,760,000,000원" },
    { name: "핫 링 에바론", price: "2,780,000,000원" },
    { name: "노박", price: "2,820,000,000원" },
    { name: "비반나이트", price: "3,760,000,000원" },
    { name: "에스트론", price: "3,880,000,000원" },
    { name: "하바네로", price: "5,000,000,000원" }
  ],
  "소형": [
    { name: "이씨클래식", price: "1,500,000,000원" },
    { name: "브리오소", price: "2,640,000,000원" }
  ]
};
</script>

    <script>
/* ---------- 차량 판매 시세표 HTML 자동 생성 ---------- */
function renderVehicleCatalog(){
  const carSection = document.querySelector('#car-sale'); // 카테고리 내 차량 판매 시세표 섹션
  if(!carSection) return;

  // 기존 내용 제거
  const oldGrid = carSection.querySelector('.car-sale-grid');
  if(oldGrid) oldGrid.remove();

  // 새 컨테이너
  const grid = document.createElement('div');
  grid.className = 'car-sale-grid';

  // 카테고리별 반복
  Object.keys(VEHICLE_CATALOG).forEach(category=>{
    const cars = VEHICLE_CATALOG[category];
    // 카테고리 제목 추가
    const h3 = document.createElement('h3');
    h3.textContent = '🚗 ' + category;
    h3.style.gridColumn = '1/-1';
    h3.style.fontSize = '20px';
    h3.style.fontWeight = '800';
    h3.style.marginTop = '40px';
    grid.appendChild(h3);

    cars.forEach(car=>{
      const card = document.createElement('div');
      card.className = 'car-card';
      card.dataset.car = car.name;
      card.innerHTML = `
        <div class="icon">🚘</div>
        <h4>${car.name}</h4>
        <p class="price">${car.price}</p>
        ${car.note?`<p style="font-size:13px;color:#6b7280;margin:4px 0 0">${car.note}</p>`:""}
      `;
      grid.appendChild(card);
    });
  });

  carSection.appendChild(grid);
}

/* ---------- 차량 상세 모달 ---------- */
function openCarModal(){
  const modal = document.getElementById('carModal');
  modal.classList.add('show');
  modal.setAttribute('aria-hidden','false');
  document.body.style.overflow='hidden';
}
function closeCarModal(){
  const modal = document.getElementById('carModal');
  modal.classList.remove('show');
  modal.setAttribute('aria-hidden','true');
  document.body.style.overflow='';
}

/* ---------- 차량 카드 클릭 이벤트 ---------- */
document.addEventListener('click', e=>{
  const card = e.target.closest('.car-card');
  if(!card) return;
  const name = card.dataset.car;

  // VEHICLE_CATALOG 에서 해당 차량 찾기
  let found=null;
  for(const cat in VEHICLE_CATALOG){
    const arr=VEHICLE_CATALOG[cat];
    const car=arr.find(c=>c.name===name);
    if(car){found=car;break;}
  }

  document.getElementById('carModalTitle').textContent = found?.name || '차량';
  document.getElementById('carModalPrice').textContent = '가격: ' + (found?.price || '-');
  document.getElementById('carModalDesc').textContent = found?.note || '세부 정보가 없습니다.';
  openCarModal();
});

/* ---------- 페이지 로딩 시 실행 ---------- */
document.addEventListener('DOMContentLoaded', ()=>{
  renderVehicleCatalog();
});
</script>

    <!-- ===== Firebase + Firestore (사연 신청 + 목록) ===== -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-app.js";
  import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-analytics.js";
  import { getFirestore, collection, addDoc, serverTimestamp, query, orderBy, limit, onSnapshot } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-firestore.js";
  import { getAuth, signInAnonymously } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-auth.js";

  const firebaseConfig = {
    apiKey: "AIzaSyBQt_sPa5B4rHWAHTn9piQ6mYYmTDpxykM",
    authDomain: "information-5461a.firebaseapp.com",
    projectId: "information-5461a",
    storageBucket: "information-5461a.firebasestorage.app",
    messagingSenderId: "1051085585657",
    appId: "1:1051085585657:web:c9b43d1b000aa30a233628",
    measurementId: "G-2VD58S8V9C"
  };

  const app = initializeApp(firebaseConfig);
  try { getAnalytics(app); } catch(e){}
  const db = getFirestore(app);
  const auth = getAuth(app);

  signInAnonymously(auth).catch(console.error);

  const storiesRef = collection(db, "stories");

  /* ---- 폼 엘리먼트 ---- */
  const storyForm = document.getElementById("storyForm");
  const storyNick = document.getElementById("storyNick");
  const storyCode = document.getElementById("storyCode");
  const storyTitle = document.getElementById("storyTitle");
  const storyBody = document.getElementById("storyBody");
  const storyMsg  = document.getElementById("storyMsg");
  const storySong = document.getElementById("storySong");
  const storyCategory = document.getElementById("storyCategory");
  const anonSwitch = document.getElementById("anonSwitch");
  const storyList = document.getElementById("storyList");
  const storyFilter = document.getElementById("storyFilter");

  /* ---- 익명 스위치 ---- */
  function setAnon(active){
    anonSwitch.classList.toggle('active', !!active);
    anonSwitch.setAttribute('aria-checked', active ? 'true' : 'false');
    updateAnonUI();
  }
  function updateAnonUI(){
    const anon = anonSwitch.classList.contains('active');
    [storyNick, storyCode].forEach((el)=>{
      el.disabled = anon;
      if(anon) el.value = '';
      if(el === storyNick) el.placeholder = anon ? '익명 모드' : '닉네임';
      if(el === storyCode) el.placeholder = anon ? '익명 모드' : '고번 (예: 251)';
    });
  }
  setAnon(false);
  updateAnonUI();
  anonSwitch.addEventListener('click', ()=> setAnon(!anonSwitch.classList.contains('active')));
  anonSwitch.addEventListener('keydown', (e)=>{ if(e.key===' '||e.key==='Enter'){ e.preventDefault(); setAnon(!anonSwitch.classList.contains('active')); }});

  /* ---- 제출 ---- */
  storyForm?.addEventListener("submit", async (e)=>{
    e.preventDefault();
    const isAnon = anonSwitch.classList.contains('active');
    const nick  = isAnon ? "" : (storyNick.value||"").trim();
    const code  = isAnon ? "" : (storyCode.value||"").trim();
    const title = (storyTitle.value||"").trim();
    const body  = (storyBody.value||"").trim();
    const song  = (storySong.value||"").trim();
    const category = storyCategory.value || "";

    if(!title || !body || !category){
      storyMsg.textContent = "카테고리/제목/내용은 필수입니다.";
      storyMsg.style.color = "#dc2626";
      return;
    }
    if(!isAnon && !nick && !code){
      storyMsg.textContent = "익명이 아니면 닉네임 또는 고번을 입력하세요.";
      storyMsg.style.color = "#dc2626";
      return;
    }

    storyForm.querySelector("button[type=submit]").disabled = true;
    storyMsg.textContent = "전송 중...";
    storyMsg.style.color = "#6b7280";
    try{
      await addDoc(storiesRef, { isAnon, nick, code, title, body, song, category, createdAt: serverTimestamp() });
      storyMsg.textContent = "사연이 접수되었습니다! 감사합니다.";
      storyMsg.style.color = "#16a34a";
      storyTitle.value = "";
      storyBody.value = "";
      storySong.value = "";
    }catch(err){
      storyMsg.textContent = "사연 전송 실패: " + (err?.message||err);
      storyMsg.style.color = "#dc2626";
    }finally{
      storyForm.querySelector("button[type=submit]").disabled = false;
    }
  });

  /* ---- 최신 사연 구독 + 렌더러 ---- */
  const storyMap = new Map();
  function fmtTime(ts){
    try{
      const d = ts?.toDate ? ts.toDate() : (ts instanceof Date ? ts : new Date());
      const y = d.getFullYear(), m = ('0'+(d.getMonth()+1)).slice(-2), da=('0'+d.getDate()).slice(-2);
      const hh=('0'+d.getHours()).slice(-2), mm=('0'+d.getMinutes()).slice(-2);
      return `${y}.${m}.${da} ${hh}:${mm}`;
    }catch{ return ""; }
  }

  function renderStoryList(){
    const filterCat = storyFilter?.value || "";
    const all = Array.from(storyMap.values());
    const arr = all.filter(s=> !filterCat || s.category === filterCat);

    if(arr.length===0){
      storyList.innerHTML = `<li class="story-empty">아직 등록된 사연이 없습니다.</li>`;
      return;
    }
    storyList.innerHTML = arr.map(s=>{
      const who  = s.isAnon ? '익명' : (s.nick || '—');
      const code = (!s.isAnon && s.code) ? ` (${s.code})` : '';
      const song = s.song ? ` · 🎵 ${s.song}` : '';
      return `
        <li class="story-item" data-id="${s.id}">
          <div class="left">
            <span class="badge">${s.category||'기타'}</span>
            <div style="display:flex;flex-direction:column;min-width:0">
              <div class="title">${s.title||'(제목 없음)'}</div>
              <div class="meta">${who}${code} · ${s._time || ''}${song}</div>
            </div>
          </div>
          <div class="meta">보기 ▸</div>
        </li>
      `;
    }).join('');

    storyList.querySelectorAll('.story-item').forEach(li=>{
      li.addEventListener('click', ()=> openStory(li.getAttribute('data-id')));
    });
  }

  const qLatest = query(storiesRef, orderBy('createdAt','desc'), limit(50));
  onSnapshot(qLatest, (snap)=>{
    storyMap.clear();
    snap.forEach(doc=>{
      const s = { id: doc.id, ...doc.data() };
      s._time = s.createdAt ? fmtTime(s.createdAt) : '';
      storyMap.set(s.id, s);
    });
    renderStoryList();
  });

  storyFilter?.addEventListener('change', renderStoryList);
</script>
</body>
</html>
